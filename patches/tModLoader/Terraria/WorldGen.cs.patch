--- src/Terraria\Terraria\WorldGen.cs
+++ src/tModLoader\Terraria\WorldGen.cs
@@ -18,6 +_,8 @@
 using Terraria.ObjectData;
 using Terraria.Utilities;
 using Terraria.World.Generation;
+using Terraria.ModLoader;
+using Terraria.ModLoader.IO;
 
 #if CLIENT
 using Terraria.Map;
@@ -548,7 +_,13 @@
 		private static int lAltarY;
 		public static int tileReframeCount = 0;
 		public static bool noMapUpdate = false;
+		public static StructureMap structures;
+		public static double worldSurface;
 		public static double worldSurfaceLow;
+		public static double worldSurfaceHigh;
+		public static double rockLayer;
+		public static double rockLayerLow;
+		public static double rockLayerHigh;
 		public static int tLeft;
 		public static int tRight;
 		public static int tTop;
@@ -906,7 +_,7 @@
 					return true;
 				}
 			}
-			for (int j = 0; j < 580; j++)
+			for (int j = 0; j < Main.nextNPC.Length; j++)
 			{
 				if (Main.nextNPC[j] && WorldGen.CheckConditions(j))
 				{
@@ -931,6 +_,10 @@
 
 		public static bool CheckConditions(int type)
 		{
+			if (!NPCLoader.CheckConditions(type))
+			{
+				return false;
+			}
 			if (type != 160)
 			{
 				return true;
@@ -1644,7 +_,7 @@
 												}
 											}
 										}
-										else if (Main.tile[num9, num10].type == 21)
+										else if (TileLoader.IsChest(Main.tile[num9, num10].type))
 										{
 											if (num8 > 0)
 											{
@@ -1752,7 +_,7 @@
 			WorldGen.roomY2 = y;
 			WorldGen.numRoomTiles = 0;
 			WorldGen.roomCeilingsCount = 0;
-			for (int i = 0; i < 467; i++)
+			for (int i = 0; i < WorldGen.houseTile.Length; i++)
 			{
 				WorldGen.houseTile[i] = false;
 			}
@@ -1827,7 +_,7 @@
 				{
 					return;
 				}
-				if (Main.tile[x, y].type == 11 && (Main.tile[x, y].frameX == 0 || Main.tile[x, y].frameX == 54))
+				if (TileLoader.CloseDoorID(Main.tile[x, y]) >= 0 && (Main.tile[x, y].frameX == 0 || Main.tile[x, y].frameX == 54))
 				{
 					return;
 				}
@@ -2024,7 +_,7 @@
 			{
 				for (int n = j - num; n < j + num; n++)
 				{
-					if (Main.tile[m, n].active() && Main.tile[m, n].type == 21)
+					if (Main.tile[m, n].active() && TileLoader.IsChest(Main.tile[m, n].type))
 					{
 						return false;
 					}
@@ -2170,6 +_,18 @@
 
 		public static void worldGenCallBack(object threadContext)
 		{
+			try
+			{
+				do_worldGenCallBack(threadContext);
+			}
+			catch (Exception e)
+			{
+				ErrorLogger.LogException(e);
+			}
+		}
+
+		public static void do_worldGenCallBack(object threadContext)
+		{
 			Main.PlaySound(10, -1, -1, 1, 1f, 0f);
 			WorldGen.clearWorld();
 			WorldGen.generateWorld(Main.ActiveWorldFileData.Seed, threadContext as GenerationProgress);
@@ -2232,11 +_,24 @@
 		public static void SaveAndQuit(Action callback = null)
 		{
 			Main.PlaySound(11, -1, -1, 1, 1f, 0f);
+			ModHooks.PreSaveAndQuit();
 			ThreadPool.QueueUserWorkItem(new WaitCallback(WorldGen.SaveAndQuitCallBack), callback);
 		}
 
 		public static void playWorldCallBack(object threadContext)
 		{
+			try
+			{
+				do_playWorldCallBack(threadContext);
+			}
+			catch (Exception e)
+			{
+				ErrorLogger.LogException(e);
+			}
+		}
+
+		public static void do_playWorldCallBack(object threadContext)
+		{
 			if (Main.rand == null)
 			{
 				Main.rand = new UnifiedRandom((int)DateTime.Now.Ticks);
@@ -2278,12 +_,19 @@
 					{
 						if (!WorldGen.worldBackup)
 						{
-							Console.WriteLine(Language.GetTextValue("Error.LoadFailedNoBackup"));
+							string message = Language.GetTextValue("Error.LoadFailedNoBackup");
+							if (WorldIO.customDataFail != null)
+							{
+								message = WorldIO.customDataFail.modName + " " + message;
+								message += "\n" + WorldIO.customDataFail.InnerException;
+							}
+							Console.WriteLine(message);
 							return;
 						}
 						FileUtilities.Copy(Main.worldPathName, Main.worldPathName + ".bad", isCloudSave, true);
 						FileUtilities.Copy(Main.worldPathName + ".bak", Main.worldPathName, isCloudSave, true);
 						FileUtilities.Delete(Main.worldPathName + ".bak", isCloudSave);
+						WorldIO.LoadDedServBackup(Main.worldPathName, isCloudSave);
 						WorldFile.loadWorld(Main.ActiveWorldFileData.IsCloudSave);
 						if (WorldGen.loadFailed || !WorldGen.loadSuccess)
 						{
@@ -2293,7 +_,14 @@
 								FileUtilities.Copy(Main.worldPathName, Main.worldPathName + ".bak", isCloudSave, true);
 								FileUtilities.Copy(Main.worldPathName + ".bad", Main.worldPathName, isCloudSave, true);
 								FileUtilities.Delete(Main.worldPathName + ".bad", isCloudSave);
-								Console.WriteLine(Language.GetTextValue("Error.LoadFailed"));
+								WorldIO.RevertDedServBackup(Main.worldPathName, isCloudSave);
+								string message = Language.GetTextValue("Error.LoadFailed");
+								if (WorldIO.customDataFail != null)
+								{
+									message = WorldIO.customDataFail.modName + " " + message;
+									message += "\n" + WorldIO.customDataFail.InnerException;
+								}
+								Console.WriteLine(message);
 								return;
 							}
 						}
@@ -2632,6 +_,7 @@
 				Main.liquidBuffer[num10] = new LiquidBuffer();
 			}
 			WorldGen.setWorldSize();
+			WorldHooks.SetupWorld();
 			WorldGen.worldCleared = true;
 		}
 
@@ -4431,13 +_,13 @@
 			WorldGen._generator = new WorldGenerator(seed);
 			Main.rand = new UnifiedRandom(seed);
 			MicroBiome.ResetAll();
-			StructureMap structures = new StructureMap();
-			double worldSurface = 0.0;
+			structures = new StructureMap();
+			worldSurface = 0.0;
 			WorldGen.worldSurfaceLow = 0.0;
-			double worldSurfaceHigh = 0.0;
-			double rockLayer = 0.0;
-			double rockLayerLow = 0.0;
-			double rockLayerHigh = 0.0;
+			worldSurfaceHigh = 0.0;
+			rockLayer = 0.0;
+			rockLayerLow = 0.0;
+			rockLayerHigh = 0.0;
 			int copper = 7;
 			int iron = 6;
 			int silver = 9;
@@ -4478,6 +_,7 @@
 					}
 				}
 			}
+			WorldHooks.PreWorldGen();
 			WorldGen.AddGenerationPass("Reset", delegate(GenerationProgress progress)
 				{
 					Liquid.ReInit();
@@ -7343,7 +_,7 @@
 									int num12 = WorldGen.genRand.Next(num - m, num + m + 1);
 									int num13 = WorldGen.genRand.Next(num2 - num6, num2 + num6 - 2);
 									WorldGen.PlaceTile(num12, num13, 4, true, false, -1, 3);
-									if (Main.tile[num12, num13].type == 4)
+									if (TileLoader.IsTorch(Main.tile[num12, num13].type))
 									{
 										flag3 = true;
 									}
@@ -10292,7 +_,7 @@
 				});
 			WorldGen.AddGenerationPass("Micro Biomes", delegate(GenerationProgress progress)
 				{
-					progress.Message = Lang.gen[76];
+					progress.Message = Lang.gen[76] + "..Thin Ice";
 					float num = (float)(Main.maxTilesX * Main.maxTilesY) / 5040000f;
 					float num2 = (float)Main.maxTilesX / 4200f;
 					int num3 = (int)((float)WorldGen.genRand.Next(3, 6) * num);
@@ -10305,6 +_,7 @@
 						}
 					}
 					progress.Set(0.1f);
+					progress.Message = Lang.gen[76] + "..Enchanted Swords";
 					int num4 = (int)Math.Ceiling((double)num);
 					int l = 0;
 					while (l < num4)
@@ -10325,6 +_,7 @@
 						}
 					}
 					progress.Set(0.2f);
+					progress.Message = Lang.gen[76] + "..Campsites";
 					int num5 = (int)((float)WorldGen.genRand.Next(6, 12) * num);
 					int m = 0;
 					while (m < num5)
@@ -10334,6 +_,8 @@
 							m++;
 						}
 					}
+					progress.Message = Lang.gen[76] + "..Mining Explosives";
+					progress.Set(0.25f);
 					int num6 = (int)((float)WorldGen.genRand.Next(14, 30) * num);
 					int n = 0;
 					while (n < num6)
@@ -10343,6 +_,7 @@
 							n++;
 						}
 					}
+					progress.Message = Lang.gen[76] + "..Mahogany Trees";
 					progress.Set(0.3f);
 					int num7 = (int)((float)WorldGen.genRand.Next(6, 12) * num2);
 					int num8 = 0;
@@ -10355,6 +_,7 @@
 						}
 						num9++;
 					}
+					progress.Message = Lang.gen[76] + "..Corruption Pits";
 					progress.Set(0.4f);
 					if (!WorldGen.crimson)
 					{
@@ -10368,6 +_,8 @@
 							}
 						}
 					}
+					progress.Message = Lang.gen[76] + "..Minecart Tracks";
+					progress.Set(0.5f);
 					TrackGenerator.Run((int)(10f * num), (int)(num * 25f) + 250);
 					progress.Set(1f);
 				});
@@ -10419,7 +_,9 @@
 					WorldGen.gen = false;
 					Main.AnglerQuestSwap();
 				});
+			WorldHooks.ModifyWorldGenTasks(WorldGen._generator._passes, ref WorldGen._generator._totalLoadWeight);
 			WorldGen._generator.GenerateWorld(customProgressObject);
+			WorldHooks.PostWorldGen();
 			Main.WorldFileMetadata = FileMetadata.FromCurrentSettings(FileType.World);
 		}
 
@@ -10446,7 +_,7 @@
 		public static bool GrowPalmTree(int i, int y)
 		{
 			int num = y;
-			while (Main.tile[i, num].type == 20)
+			while (TileLoader.IsSapling(Main.tile[i, num].type))
 			{
 				num++;
 			}
@@ -10460,7 +_,7 @@
 			{
 				return false;
 			}
-			if (tile.type != 53 && tile.type != 234 && tile.type != 116 && tile.type != 112)
+			if (tile.type != 53 && tile.type != 234 && tile.type != 116 && tile.type != 112 && !TileLoader.CanGrowModPalmTree(tile.type))
 			{
 				return false;
 			}
@@ -10518,11 +_,11 @@
 		public static bool GrowEpicTree(int i, int y)
 		{
 			int num = y;
-			while (Main.tile[i, num].type == 20)
+			while (TileLoader.IsSapling(Main.tile[i, num].type))
 			{
 				num++;
 			}
-			if (Main.tile[i, num].active() && !Main.tile[i, num].halfBrick() && Main.tile[i, num].slope() == 0 && Main.tile[i, num].type == 2 && Main.tile[i, num - 1].wall == 0 && Main.tile[i, num - 1].liquid == 0 && ((Main.tile[i - 1, num].active() && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109)) || (Main.tile[i + 1, num].active() && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109))))
+			if (Main.tile[i, num].active() && !Main.tile[i, num].halfBrick() && Main.tile[i, num].slope() == 0 && Main.tile[i, num].type == 2 && Main.tile[i, num - 1].wall == 0 && Main.tile[i, num - 1].liquid == 0 && ((Main.tile[i - 1, num].active() && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || TileLoader.CanGrowModTree(Main.tile[i - 1, num].type))) || (Main.tile[i + 1, num].active() && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || TileLoader.CanGrowModTree(Main.tile[i + 1, num].type)))))
 			{
 				int num2 = 2;
 				if (WorldGen.EmptyTileCheck(i - num2, i + num2, num - 55, num - 1, 20))
@@ -10788,11 +_,11 @@
 					int num6 = WorldGen.genRand.Next(3);
 					bool flag3 = false;
 					bool flag4 = false;
-					if (Main.tile[i - 1, num].active() && !Main.tile[i - 1, num].halfBrick() && Main.tile[i - 1, num].slope() == 0 && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109))
+					if (Main.tile[i - 1, num].active() && !Main.tile[i - 1, num].halfBrick() && Main.tile[i - 1, num].slope() == 0 && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || TileLoader.CanGrowModTree(Main.tile[i - 1, num].type)))
 					{
 						flag3 = true;
 					}
-					if (Main.tile[i + 1, num].active() && !Main.tile[i + 1, num].halfBrick() && Main.tile[i + 1, num].slope() == 0 && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109))
+					if (Main.tile[i + 1, num].active() && !Main.tile[i + 1, num].halfBrick() && Main.tile[i + 1, num].slope() == 0 && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || TileLoader.CanGrowModTree(Main.tile[i + 1, num].type)))
 					{
 						flag4 = true;
 					}
@@ -11943,10 +_,21 @@
 						}
 					}
 					ushort type = tile3.type;
+					TileLoader.TreeGrowthFXGore(type, ref num2);
+					if (num2 > 0)
+					{
+						break;
+					}
+					TileLoader.PalmTreeGrowthFXGore(type, ref num2);
+					if (num2 > 0)
+					{
+						break;
+					}
 					if (type <= 70)
 					{
 						if (type <= 23)
 						{
+							//patch file: num2
 							if (type == 2)
 							{
 								num2 = 910;
@@ -12100,7 +_,7 @@
 		public static bool GrowTree(int i, int y)
 		{
 			int num = y;
-			while (Main.tile[i, num].type == 20)
+			while (TileLoader.IsSapling(Main.tile[i, num].type))
 			{
 				num++;
 			}
@@ -12108,7 +_,7 @@
 			{
 				return false;
 			}
-			if (Main.tile[i, num].nactive() && !Main.tile[i, num].halfBrick() && Main.tile[i, num].slope() == 0 && (Main.tile[i, num].type == 2 || Main.tile[i, num].type == 23 || Main.tile[i, num].type == 60 || Main.tile[i, num].type == 109 || Main.tile[i, num].type == 147 || Main.tile[i, num].type == 199 || Main.tile[i, num].type == 70) && (Main.tile[i, num - 1].wall == 0 || Main.tile[i, num - 1].wall == 106 || Main.tile[i, num - 1].wall == 107 || (Main.tile[i, num - 1].wall >= 138 && Main.tile[i, num - 1].wall <= 141) || Main.tile[i, num - 1].wall == 145 || Main.tile[i, num - 1].wall == 150 || Main.tile[i, num - 1].wall == 152) && ((Main.tile[i - 1, num].active() && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || Main.tile[i - 1, num].type == 147 || Main.tile[i - 1, num].type == 199 || Main.tile[i - 1, num].type == 70)) || (Main.tile[i + 1, num].active() && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || Main.tile[i + 1, num].type == 147 || Main.tile[i + 1, num].type == 199 || Main.tile[i + 1, num].type == 70))))
+			if (Main.tile[i, num].nactive() && !Main.tile[i, num].halfBrick() && Main.tile[i, num].slope() == 0 && (Main.tile[i, num].type == 2 || Main.tile[i, num].type == 23 || Main.tile[i, num].type == 60 || Main.tile[i, num].type == 109 || Main.tile[i, num].type == 147 || Main.tile[i, num].type == 199 || Main.tile[i, num].type == 70 || TileLoader.CanGrowModTree(Main.tile[i, num].type)) && (Main.tile[i, num - 1].wall == 0 || Main.tile[i, num - 1].wall == 106 || Main.tile[i, num - 1].wall == 107 || (Main.tile[i, num - 1].wall >= 138 && Main.tile[i, num - 1].wall <= 141) || Main.tile[i, num - 1].wall == 145 || Main.tile[i, num - 1].wall == 150 || Main.tile[i, num - 1].wall == 152) && ((Main.tile[i - 1, num].active() && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || Main.tile[i - 1, num].type == 147 || Main.tile[i - 1, num].type == 199 || Main.tile[i - 1, num].type == 70 || TileLoader.CanGrowModTree(Main.tile[i - 1, num].type))) || (Main.tile[i + 1, num].active() && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || Main.tile[i + 1, num].type == 147 || Main.tile[i + 1, num].type == 199 || Main.tile[i + 1, num].type == 70 || TileLoader.CanGrowModTree(Main.tile[i + 1, num].type)))))
 			{
 				int num2 = 2;
 				int num3 = 16;
@@ -12379,11 +_,11 @@
 					int num7 = WorldGen.genRand.Next(3);
 					bool flag3 = false;
 					bool flag4 = false;
-					if (Main.tile[i - 1, num].nactive() && !Main.tile[i - 1, num].halfBrick() && Main.tile[i - 1, num].slope() == 0 && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || Main.tile[i - 1, num].type == 147 || Main.tile[i - 1, num].type == 199))
+					if (Main.tile[i - 1, num].nactive() && !Main.tile[i - 1, num].halfBrick() && Main.tile[i - 1, num].slope() == 0 && (Main.tile[i - 1, num].type == 2 || Main.tile[i - 1, num].type == 23 || Main.tile[i - 1, num].type == 60 || Main.tile[i - 1, num].type == 109 || Main.tile[i - 1, num].type == 147 || Main.tile[i - 1, num].type == 199 || TileLoader.CanGrowModTree(Main.tile[i - 1, num].type)))
 					{
 						flag3 = true;
 					}
-					if (Main.tile[i + 1, num].nactive() && !Main.tile[i + 1, num].halfBrick() && Main.tile[i + 1, num].slope() == 0 && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || Main.tile[i + 1, num].type == 147 || Main.tile[i + 1, num].type == 199))
+					if (Main.tile[i + 1, num].nactive() && !Main.tile[i + 1, num].halfBrick() && Main.tile[i + 1, num].slope() == 0 && (Main.tile[i + 1, num].type == 2 || Main.tile[i + 1, num].type == 23 || Main.tile[i + 1, num].type == 60 || Main.tile[i + 1, num].type == 109 || Main.tile[i + 1, num].type == 147 || Main.tile[i + 1, num].type == 199 || TileLoader.CanGrowModTree(Main.tile[i + 1, num].type)))
 					{
 						flag4 = true;
 					}
@@ -13157,14 +_,14 @@
 								return false;
 							}
 						}
-						else if (ignoreID == 20)
+						else if (TileLoader.IsSapling(ignoreID))
 						{
 							ushort type3 = Main.tile[i, j].type;
-							if (type3 <= 74)
-							{
-								if (type3 <= 24)
-								{
-									if (type3 == 3 || type3 == 20 || type3 == 24)
+							if (type3 <= 74 || TileLoader.IsSapling(type3))
+							{
+								if (type3 <= 24 || TileLoader.IsSapling(type3))
+								{
+									if (type3 == 3 || TileLoader.IsSapling(type3) || type3 == 24)
 									{
 										goto IL_159;
 									}
@@ -13411,7 +_,7 @@
 				Main.tile[i, j] = new Tile();
 			}
 			int frameX = (int)Main.tile[i, j].frameX;
-			if (Main.tile[i, j].type != 11)
+			if (TileLoader.CloseDoorID(Main.tile[i, j]) < 0)
 			{
 				return false;
 			}
@@ -13458,6 +_,7 @@
 					}
 				}
 			}
+			ushort closeDoorID = (ushort)TileLoader.CloseDoorID(Main.tile[i, j]);
 			for (int m = num5; m < num5 + 2; m++)
 			{
 				for (int n = num4; n < num4 + 3; n++)
@@ -13468,7 +_,7 @@
 						{
 							Main.tile[m, n] = new Tile();
 						}
-						Main.tile[m, n].type = 10;
+						Main.tile[m, n].type = closeDoorID;
 						Main.tile[m, n].frameX = (short)(WorldGen.genRand.Next(3) * 18);
 					}
 					else
@@ -13666,7 +_,7 @@
 							{
 								for (int k = num8 - 8; k < num8 + 8; k++)
 								{
-									if (Main.tile[j, k].active() && Main.tile[j, k].type == 4)
+									if (Main.tile[j, k].active() && TileLoader.IsTorch(Main.tile[j, k].type))
 									{
 										flag2 = true;
 										break;
@@ -20140,11 +_,7 @@
 			{
 				Main.tile[i, j] = new Tile();
 			}
-			if (Main.tile[i, j].type != 10)
-			{
-				return false;
-			}
-			if (Main.tile[i, j].frameY >= 594 && Main.tile[i, j].frameY <= 646)
+			if (TileLoader.OpenDoorID(Main.tile[i, j]) < 0)
 			{
 				return false;
 			}
@@ -20207,8 +_,9 @@
 			}
 			int num6 = num * 54;
 			Main.PlaySound(8, i * 16, j * 16, 1, 1f, 0f);
+			ushort openDoorID = (ushort)TileLoader.OpenDoorID(Main.tile[i, j]);
 			Main.tile[num4, num2].active(true);
-			Main.tile[num4, num2].type = 11;
+			Main.tile[num4, num2].type = openDoorID;
 			Main.tile[num4, num2].frameY = (short)num6;
 			Main.tile[num4, num2].frameX = num3;
 			Main.tile[num4, num2].color(color);
@@ -20217,7 +_,7 @@
 				Main.tile[num4 + 1, num2] = new Tile();
 			}
 			Main.tile[num4 + 1, num2].active(true);
-			Main.tile[num4 + 1, num2].type = 11;
+			Main.tile[num4 + 1, num2].type = openDoorID;
 			Main.tile[num4 + 1, num2].frameY = (short)num6;
 			Main.tile[num4 + 1, num2].frameX = (short)(num3 + 18);
 			Main.tile[num4 + 1, num2].color(color);
@@ -20226,7 +_,7 @@
 				Main.tile[num4, num2 + 1] = new Tile();
 			}
 			Main.tile[num4, num2 + 1].active(true);
-			Main.tile[num4, num2 + 1].type = 11;
+			Main.tile[num4, num2 + 1].type = openDoorID;
 			Main.tile[num4, num2 + 1].frameY = (short)(num6 + 18);
 			Main.tile[num4, num2 + 1].frameX = num3;
 			Main.tile[num4, num2 + 1].color(color2);
@@ -20235,7 +_,7 @@
 				Main.tile[num4 + 1, num2 + 1] = new Tile();
 			}
 			Main.tile[num4 + 1, num2 + 1].active(true);
-			Main.tile[num4 + 1, num2 + 1].type = 11;
+			Main.tile[num4 + 1, num2 + 1].type = openDoorID;
 			Main.tile[num4 + 1, num2 + 1].frameY = (short)(num6 + 18);
 			Main.tile[num4 + 1, num2 + 1].frameX = (short)(num3 + 18);
 			Main.tile[num4 + 1, num2 + 1].color(color2);
@@ -20244,7 +_,7 @@
 				Main.tile[num4, num2 + 2] = new Tile();
 			}
 			Main.tile[num4, num2 + 2].active(true);
-			Main.tile[num4, num2 + 2].type = 11;
+			Main.tile[num4, num2 + 2].type = openDoorID;
 			Main.tile[num4, num2 + 2].frameY = (short)(num6 + 36);
 			Main.tile[num4, num2 + 2].frameX = num3;
 			Main.tile[num4, num2 + 2].color(color3);
@@ -20253,7 +_,7 @@
 				Main.tile[num4 + 1, num2 + 2] = new Tile();
 			}
 			Main.tile[num4 + 1, num2 + 2].active(true);
-			Main.tile[num4 + 1, num2 + 2].type = 11;
+			Main.tile[num4 + 1, num2 + 2].type = openDoorID;
 			Main.tile[num4 + 1, num2 + 2].frameY = (short)(num6 + 36);
 			Main.tile[num4 + 1, num2 + 2].frameX = (short)(num3 + 18);
 			Main.tile[num4 + 1, num2 + 2].color(color3);
@@ -20330,99 +_,102 @@
 						WorldGen.KillTile(x, num4 + l, false, false, false);
 					}
 				}
-				if (type == 92)
-				{
-					Item.NewItem(x * 16, j * 16, 32, 32, 341, 1, false, 0, false, false);
-				}
-				if (type == 453)
-				{
-					int type2;
-					if (num3 < 2)
-					{
-						type2 = 3744;
-					}
-					else if (num3 < 4)
-					{
-						type2 = 3745;
-					}
-					else
-					{
-						type2 = 3743;
-					}
-					Item.NewItem(x * 16, j * 16, 16, 32, type2, 1, false, 0, false, false);
-				}
-				if (type == 93)
-				{
-					int type3 = 0;
-					if (num2 == 0)
-					{
-						type3 = 342;
-					}
-					else if (num2 >= 1 && num2 <= 10)
-					{
-						type3 = 2082 + num2 - 1;
-					}
-					else if (num2 >= 11 && num2 <= 16)
-					{
-						type3 = 2129 + num2 - 11;
-					}
-					else if (num2 == 17)
-					{
-						type3 = 2225;
-					}
-					else if (num2 == 18)
-					{
-						type3 = 2533;
-					}
-					else if (num2 == 19)
-					{
-						type3 = 2547;
-					}
-					else if (num2 == 20)
-					{
-						type3 = 2563;
-					}
-					else if (num2 == 21)
-					{
-						type3 = 2578;
-					}
-					else if (num2 == 22)
-					{
-						type3 = 2643;
-					}
-					else if (num2 == 23)
-					{
-						type3 = 2644;
-					}
-					else if (num2 == 24)
-					{
-						type3 = 2645;
-					}
-					else if (num2 == 25)
-					{
-						type3 = 2646;
-					}
-					else if (num2 == 26)
-					{
-						type3 = 2647;
-					}
-					else if (num2 == 27)
-					{
-						type3 = 2819;
-					}
-					else if (num2 == 28)
-					{
-						type3 = 3135;
-					}
-					else if (num2 == 29)
-					{
-						type3 = 3137;
-					}
-					else if (num2 == 30)
-					{
-						type3 = 3136;
-					}
-					Item.NewItem(x * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, j, type, TileStyle.Style1xX))
+				{
+					if (type == 92)
+					{
+						Item.NewItem(x * 16, j * 16, 32, 32, 341, 1, false, 0, false, false);
+					}
+					if (type == 453)
+					{
+						int type2;
+						if (num3 < 2)
+						{
+							type2 = 3744;
+						}
+						else if (num3 < 4)
+						{
+							type2 = 3745;
+						}
+						else
+						{
+							type2 = 3743;
+						}
+						Item.NewItem(x * 16, j * 16, 16, 32, type2, 1, false, 0, false, false);
+					}
+					if (type == 93)
+					{
+						int type3 = 0;
+						if (num2 == 0)
+						{
+							type3 = 342;
+						}
+						else if (num2 >= 1 && num2 <= 10)
+						{
+							type3 = 2082 + num2 - 1;
+						}
+						else if (num2 >= 11 && num2 <= 16)
+						{
+							type3 = 2129 + num2 - 11;
+						}
+						else if (num2 == 17)
+						{
+							type3 = 2225;
+						}
+						else if (num2 == 18)
+						{
+							type3 = 2533;
+						}
+						else if (num2 == 19)
+						{
+							type3 = 2547;
+						}
+						else if (num2 == 20)
+						{
+							type3 = 2563;
+						}
+						else if (num2 == 21)
+						{
+							type3 = 2578;
+						}
+						else if (num2 == 22)
+						{
+							type3 = 2643;
+						}
+						else if (num2 == 23)
+						{
+							type3 = 2644;
+						}
+						else if (num2 == 24)
+						{
+							type3 = 2645;
+						}
+						else if (num2 == 25)
+						{
+							type3 = 2646;
+						}
+						else if (num2 == 26)
+						{
+							type3 = 2647;
+						}
+						else if (num2 == 27)
+						{
+							type3 = 2819;
+						}
+						else if (num2 == 28)
+						{
+							type3 = 3135;
+						}
+						else if (num2 == 29)
+						{
+							type3 = 3137;
+						}
+						else if (num2 == 30)
+						{
+							type3 = 3136;
+						}
+						Item.NewItem(x * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 			}
@@ -20558,157 +_,160 @@
 						WorldGen.KillTile(num + 1, num4 + num5, false, false, false);
 					}
 				}
-				if (type == 104)
-				{
-					int num6 = frameX / 36;
-					int type2;
-					if (num6 >= 1 && num6 <= 5)
-					{
-						type2 = 2237 + num6 - 1;
-					}
-					else if (num6 == 6)
-					{
-						type2 = 2560;
-					}
-					else if (num6 == 7)
-					{
-						type2 = 2575;
-					}
-					else if (num6 >= 8 && num6 <= 23)
-					{
-						type2 = 2591 + num6 - 8;
-					}
-					else if (num6 == 24)
-					{
-						type2 = 2809;
-					}
-					else if (num6 == 25)
-					{
-						type2 = 3126;
-					}
-					else if (num6 == 26)
-					{
-						type2 = 3128;
-					}
-					else if (num6 == 27)
-					{
-						type2 = 3127;
-					}
-					else
-					{
-						type2 = 359;
-					}
-					Item.NewItem(num * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				if (type == 105)
-				{
-					int num7 = frameX / 36;
-					num7 += frameY / 54 * 55;
-					if (num7 == 0)
-					{
-						num7 = 360;
-					}
-					else if (num7 == 1)
-					{
-						num7 = 52;
-					}
-					else if (num7 == 43)
-					{
-						num7 = 1152;
-					}
-					else if (num7 == 44)
-					{
-						num7 = 1153;
-					}
-					else if (num7 == 45)
-					{
-						num7 = 1154;
-					}
-					else if (num7 == 46)
-					{
-						num7 = 1408;
-					}
-					else if (num7 == 47)
-					{
-						num7 = 1409;
-					}
-					else if (num7 == 48)
-					{
-						num7 = 1410;
-					}
-					else if (num7 == 49)
-					{
-						num7 = 1462;
-					}
-					else if (num7 == 50)
-					{
-						num7 = 2672;
-					}
-					else if (num7 >= 51 && num7 <= 62)
-					{
-						num7 = 3651 + num7 - 51;
-					}
-					else if (num7 >= 63 && num7 <= 75)
-					{
-						num7 = 3708 + num7 - 63;
-					}
-					else
-					{
-						num7 = 438 + num7 - 2;
-					}
-					Item.NewItem(num * 16, j * 16, 32, 32, num7, 1, false, 0, false, false);
-				}
-				if (type == 356)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 32, 3064, 1, false, 0, false, false);
-				}
-				if (type == 456)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 32, 3748, 1, false, 0, false, false);
-				}
-				if (type == 337)
-				{
-					int num8 = frameX / 36;
-					Item.NewItem(num * 16, j * 16, 32, 32, 2702 + num8, 1, false, 0, false, false);
-				}
-				if (type == 207)
-				{
-					int num9 = frameX / 36;
-					if (num9 == 0)
-					{
-						num9 = 909;
-					}
-					else if (num9 == 1)
-					{
-						num9 = 910;
-					}
-					else if (num9 >= 2 && num9 <= 7)
-					{
-						num9 = 938 + num9;
-					}
-					Item.NewItem(num * 16, j * 16, 32, 32, num9, 1, false, 0, false, false);
-				}
-				if (type == 410)
-				{
-					int num10 = frameX / 36;
-					Item.NewItem(num * 16, j * 16, 32, 32, num10 + 3536, 1, false, 0, false, false);
-				}
-				if (type == 320)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 32, 2496, 1, false, 0, false, false);
-				}
-				if (type == 349)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 32, 470, 1, false, 0, false, false);
-				}
-				if (type == 465)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 32, 3815, 1, false, 0, false, false);
-				}
-				if (type == 378)
-				{
-					Item.NewItem(num * 16, j * 16, 32, 48, 3202, 1, false, 0, false, false);
-					TETrainingDummy.Kill(num, num4);
+				if (TileLoader.Drop(num, j, type, TileStyle.Style2xX))
+				{
+					if (type == 104)
+					{
+						int num6 = frameX / 36;
+						int type2;
+						if (num6 >= 1 && num6 <= 5)
+						{
+							type2 = 2237 + num6 - 1;
+						}
+						else if (num6 == 6)
+						{
+							type2 = 2560;
+						}
+						else if (num6 == 7)
+						{
+							type2 = 2575;
+						}
+						else if (num6 >= 8 && num6 <= 23)
+						{
+							type2 = 2591 + num6 - 8;
+						}
+						else if (num6 == 24)
+						{
+							type2 = 2809;
+						}
+						else if (num6 == 25)
+						{
+							type2 = 3126;
+						}
+						else if (num6 == 26)
+						{
+							type2 = 3128;
+						}
+						else if (num6 == 27)
+						{
+							type2 = 3127;
+						}
+						else
+						{
+							type2 = 359;
+						}
+						Item.NewItem(num * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					if (type == 105)
+					{
+						int num7 = frameX / 36;
+						num7 += frameY / 54 * 55;
+						if (num7 == 0)
+						{
+							num7 = 360;
+						}
+						else if (num7 == 1)
+						{
+							num7 = 52;
+						}
+						else if (num7 == 43)
+						{
+							num7 = 1152;
+						}
+						else if (num7 == 44)
+						{
+							num7 = 1153;
+						}
+						else if (num7 == 45)
+						{
+							num7 = 1154;
+						}
+						else if (num7 == 46)
+						{
+							num7 = 1408;
+						}
+						else if (num7 == 47)
+						{
+							num7 = 1409;
+						}
+						else if (num7 == 48)
+						{
+							num7 = 1410;
+						}
+						else if (num7 == 49)
+						{
+							num7 = 1462;
+						}
+						else if (num7 == 50)
+						{
+							num7 = 2672;
+						}
+						else if (num7 >= 51 && num7 <= 62)
+						{
+							num7 = 3651 + num7 - 51;
+						}
+						else if (num7 >= 63 && num7 <= 75)
+						{
+							num7 = 3708 + num7 - 63;
+						}
+						else
+						{
+							num7 = 438 + num7 - 2;
+						}
+						Item.NewItem(num * 16, j * 16, 32, 32, num7, 1, false, 0, false, false);
+					}
+					if (type == 356)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 32, 3064, 1, false, 0, false, false);
+					}
+					if (type == 456)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 32, 3748, 1, false, 0, false, false);
+					}
+					if (type == 337)
+					{
+						int num8 = frameX / 36;
+						Item.NewItem(num * 16, j * 16, 32, 32, 2702 + num8, 1, false, 0, false, false);
+					}
+					if (type == 207)
+					{
+						int num9 = frameX / 36;
+						if (num9 == 0)
+						{
+							num9 = 909;
+						}
+						else if (num9 == 1)
+						{
+							num9 = 910;
+						}
+						else if (num9 >= 2 && num9 <= 7)
+						{
+							num9 = 938 + num9;
+						}
+						Item.NewItem(num * 16, j * 16, 32, 32, num9, 1, false, 0, false, false);
+					}
+					if (type == 410)
+					{
+						int num10 = frameX / 36;
+						Item.NewItem(num * 16, j * 16, 32, 32, num10 + 3536, 1, false, 0, false, false);
+					}
+					if (type == 320)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 32, 2496, 1, false, 0, false, false);
+					}
+					if (type == 349)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 32, 470, 1, false, 0, false, false);
+					}
+					if (type == 465)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 32, 3815, 1, false, 0, false, false);
+					}
+					if (type == 378)
+					{
+						Item.NewItem(num * 16, j * 16, 32, 48, 3202, 1, false, 0, false, false);
+						TETrainingDummy.Kill(num, num4);
+					}
 				}
 				WorldGen.destroyObject = false;
 			}
@@ -21806,7 +_,8 @@
 						}
 					}
 				}
-				Item.NewItem(x * 16, y * 16, 32, 32, 1873, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, y, TileID.ChristmasTree, TileStyle.Style4x8))
+					Item.NewItem(x * 16, y * 16, 32, 32, 1873, 1, false, 0, false, false);
 				WorldGen.destroyObject = false;
 			}
 		}
@@ -21915,8 +_,10 @@
 			{
 				flag = true;
 			}
-			if (Main.tile[x, num].type == 20)
-			{
+			if (TileLoader.IsSapling(Main.tile[x, num].type))
+			{
+				int originalType = Main.tile[x, num].type;
+				int newType = TileID.Saplings;
 				int num3 = (int)(Main.tile[x, num].frameX / 54);
 				int type2 = (int)Main.tile[x, num + 2].type;
 				int num4 = -1;
@@ -21960,12 +_,17 @@
 				{
 					num4 = 9;
 				}
+				else if (TileLoader.SaplingGrowthType(type2, ref newType, ref num4))
+				{
+				}
 				else
 				{
 					flag = true;
 				}
-				if (!flag && num3 != num4)
-				{
+				if (!flag && (originalType != newType || num3 != num4))
+				{
+					Main.tile[x, num].type = (ushort)newType;
+					Main.tile[x, num + 1].type = (ushort)newType;
 					int num5 = 54 * num4;
 					num5 += WorldGen.genRand.Next(3) * 18;
 					Main.tile[x, num].frameX = (short)num5;
@@ -21983,156 +_,159 @@
 				{
 					WorldGen.KillTile(x, num + 1, false, false, false);
 				}
-				if (type == 216)
-				{
-					Item.NewItem(x * 16, num * 16, 32, 32, 970 + num2, 1, false, 0, false, false);
-				}
-				if (type == 338)
-				{
-					Item.NewItem(x * 16, num * 16, 32, 32, 2738, 1, false, 0, false, false);
-				}
-				if (type == 390)
-				{
-					Item.NewItem(x * 16, num * 16, 16, 32, 3253, 1, false, 0, false, false);
-				}
-				if (type == 15)
-				{
-					int type3;
-					if (num2 >= 18 && num2 <= 23)
-					{
-						type3 = 1703 + num2 - 18;
-					}
-					else if (num2 == 5)
-					{
-						type3 = 806;
-					}
-					else if (num2 == 6)
-					{
-						type3 = 807;
-					}
-					else if (num2 == 7)
-					{
-						type3 = 808;
-					}
-					else if (num2 == 8)
-					{
-						type3 = 809;
-					}
-					else if (num2 == 9)
-					{
-						type3 = 810;
-					}
-					else if (num2 == 10)
-					{
-						type3 = 826;
-					}
-					else if (num2 == 11)
-					{
-						type3 = 915;
-					}
-					else if (num2 == 13)
-					{
-						type3 = 1396;
-					}
-					else if (num2 == 14)
-					{
-						type3 = 1399;
-					}
-					else if (num2 == 15)
-					{
-						type3 = 1402;
-					}
-					else if (num2 == 12)
-					{
-						type3 = 1143;
-					}
-					else if (num2 == 4)
-					{
-						type3 = 630;
-					}
-					else if (num2 == 3)
-					{
-						type3 = 629;
-					}
-					else if (num2 == 2)
-					{
-						type3 = 628;
-					}
-					else if (num2 == 17)
-					{
-						type3 = 1509;
-					}
-					else if (num2 == 1)
-					{
-						type3 = 358;
-					}
-					else if (num2 == 24)
-					{
-						type3 = 1792;
-					}
-					else if (num2 == 25)
-					{
-						type3 = 1814;
-					}
-					else if (num2 == 16)
-					{
-						type3 = 1459;
-					}
-					else if (num2 == 26)
-					{
-						type3 = 1925;
-					}
-					else if (num2 == 27)
-					{
-						type3 = 2228;
-					}
-					else if (num2 == 28)
-					{
-						type3 = 2288;
-					}
-					else if (num2 == 29)
-					{
-						type3 = 2524;
-					}
-					else if (num2 == 30)
-					{
-						type3 = 2557;
-					}
-					else if (num2 == 31)
-					{
-						type3 = 2572;
-					}
-					else if (num2 == 32)
-					{
-						type3 = 2812;
-					}
-					else if (num2 == 33)
-					{
-						type3 = 3174;
-					}
-					else if (num2 == 34)
-					{
-						type3 = 3176;
-					}
-					else if (num2 == 35)
-					{
-						type3 = 3175;
-					}
-					else
-					{
-						type3 = 34;
-					}
-					Item.NewItem(x * 16, num * 16, 32, 32, type3, 1, false, 0, false, false);
-				}
-				else if (type == 134)
-				{
-					if (num2 == 1)
-					{
-						Item.NewItem(x * 16, num * 16, 32, 32, 1220, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(x * 16, num * 16, 32, 32, 525, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, num, type, TileStyle.Style1x2))
+				{
+					if (type == 216)
+					{
+						Item.NewItem(x * 16, num * 16, 32, 32, 970 + num2, 1, false, 0, false, false);
+					}
+					if (type == 338)
+					{
+						Item.NewItem(x * 16, num * 16, 32, 32, 2738, 1, false, 0, false, false);
+					}
+					if (type == 390)
+					{
+						Item.NewItem(x * 16, num * 16, 16, 32, 3253, 1, false, 0, false, false);
+					}
+					if (type == 15)
+					{
+						int type3;
+						if (num2 >= 18 && num2 <= 23)
+						{
+							type3 = 1703 + num2 - 18;
+						}
+						else if (num2 == 5)
+						{
+							type3 = 806;
+						}
+						else if (num2 == 6)
+						{
+							type3 = 807;
+						}
+						else if (num2 == 7)
+						{
+							type3 = 808;
+						}
+						else if (num2 == 8)
+						{
+							type3 = 809;
+						}
+						else if (num2 == 9)
+						{
+							type3 = 810;
+						}
+						else if (num2 == 10)
+						{
+							type3 = 826;
+						}
+						else if (num2 == 11)
+						{
+							type3 = 915;
+						}
+						else if (num2 == 13)
+						{
+							type3 = 1396;
+						}
+						else if (num2 == 14)
+						{
+							type3 = 1399;
+						}
+						else if (num2 == 15)
+						{
+							type3 = 1402;
+						}
+						else if (num2 == 12)
+						{
+							type3 = 1143;
+						}
+						else if (num2 == 4)
+						{
+							type3 = 630;
+						}
+						else if (num2 == 3)
+						{
+							type3 = 629;
+						}
+						else if (num2 == 2)
+						{
+							type3 = 628;
+						}
+						else if (num2 == 17)
+						{
+							type3 = 1509;
+						}
+						else if (num2 == 1)
+						{
+							type3 = 358;
+						}
+						else if (num2 == 24)
+						{
+							type3 = 1792;
+						}
+						else if (num2 == 25)
+						{
+							type3 = 1814;
+						}
+						else if (num2 == 16)
+						{
+							type3 = 1459;
+						}
+						else if (num2 == 26)
+						{
+							type3 = 1925;
+						}
+						else if (num2 == 27)
+						{
+							type3 = 2228;
+						}
+						else if (num2 == 28)
+						{
+							type3 = 2288;
+						}
+						else if (num2 == 29)
+						{
+							type3 = 2524;
+						}
+						else if (num2 == 30)
+						{
+							type3 = 2557;
+						}
+						else if (num2 == 31)
+						{
+							type3 = 2572;
+						}
+						else if (num2 == 32)
+						{
+							type3 = 2812;
+						}
+						else if (num2 == 33)
+						{
+							type3 = 3174;
+						}
+						else if (num2 == 34)
+						{
+							type3 = 3176;
+						}
+						else if (num2 == 35)
+						{
+							type3 = 3175;
+						}
+						else
+						{
+							type3 = 34;
+						}
+						Item.NewItem(x * 16, num * 16, 32, 32, type3, 1, false, 0, false, false);
+					}
+					else if (type == 134)
+					{
+						if (num2 == 1)
+						{
+							Item.NewItem(x * 16, num * 16, 32, 32, 1220, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(x * 16, num * 16, 32, 32, 525, 1, false, 0, false, false);
+						}
 					}
 				}
 				WorldGen.destroyObject = false;
@@ -22300,31 +_,34 @@
 				{
 					Sign.KillSign(num7, num8);
 				}
-				if (type == 85)
-				{
-					int type2 = 321;
-					if (num10 >= 6 && num10 <= 10)
-					{
-						type2 = 3229 + num10 - 6;
-					}
-					else if (num10 >= 1 && num10 <= 5)
-					{
-						type2 = 1173 + num10 - 1;
-					}
-					Item.NewItem(x * 16, y * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				else if (type == 395)
-				{
-					Item.NewItem(num7 * 16, num8 * 16, 32, 32, 3270, 1, false, 0, false, false);
-					TEItemFrame.Kill(num7, num8);
-				}
-				else if (type == 425)
-				{
-					Item.NewItem(num7 * 16, num8 * 16, 32, 32, 3617, 1, false, 0, false, false);
-				}
-				else
-				{
-					Item.NewItem(x * 16, y * 16, 32, 32, 171, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, y, type, TileStyle.Style2x2))
+				{
+					if (type == 85)
+					{
+						int type2 = 321;
+						if (num10 >= 6 && num10 <= 10)
+						{
+							type2 = 3229 + num10 - 6;
+						}
+						else if (num10 >= 1 && num10 <= 5)
+						{
+							type2 = 1173 + num10 - 1;
+						}
+						Item.NewItem(x * 16, y * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					else if (type == 395)
+					{
+						Item.NewItem(num7 * 16, num8 * 16, 32, 32, 3270, 1, false, 0, false, false);
+						TEItemFrame.Kill(num7, num8);
+					}
+					else if (type == 425)
+					{
+						Item.NewItem(num7 * 16, num8 * 16, 32, 32, 3617, 1, false, 0, false, false);
+					}
+					else
+					{
+						Item.NewItem(x * 16, y * 16, 32, 32, 171, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				return;
@@ -24001,57 +_,60 @@
 						WorldGen.KillTile(x, i + l, false, false, false);
 					}
 				}
-				if (type == 91)
-				{
-					int num2 = frameX / 18;
-					num2 += num * 111;
-					if (num2 >= 278)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3559 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 273)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3516 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 272)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3780, 1, false, 0, false, false);
-					}
-					else if (num2 >= 270)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3323 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 207)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3183 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 109)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 2788 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 22)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1593 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 10 && num2 <= 15)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1441 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 16 && num2 <= 21)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1448 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 7 && num2 <= 9)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 838 + num2, 1, false, 0, false, false);
-					}
-					else if (num2 >= 4 && num2 <= 6)
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 785 + num2, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 337 + num2, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, i + 1, type, TileStyle.Style1x3))
+				{
+					if (type == 91)
+					{
+						int num2 = frameX / 18;
+						num2 += num * 111;
+						if (num2 >= 278)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3559 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 273)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3516 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 272)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3780, 1, false, 0, false, false);
+						}
+						else if (num2 >= 270)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3323 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 207)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 3183 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 109)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 2788 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 22)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1593 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 10 && num2 <= 15)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1441 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 16 && num2 <= 21)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 1448 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 7 && num2 <= 9)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 838 + num2, 1, false, 0, false, false);
+						}
+						else if (num2 >= 4 && num2 <= 6)
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 785 + num2, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(x * 16, (i + 1) * 16, 32, 32, 337 + num2, 1, false, 0, false, false);
+						}
 					}
 				}
 				WorldGen.destroyObject = false;
@@ -24242,7 +_,8 @@
 			if (flag)
 			{
 				WorldGen.destroyObject = true;
-				Item.NewItem(i * 16, j * 16, 48, 48, 2699, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, TileID.WeaponsRack, TileStyle.Style3x3))
+					Item.NewItem(i * 16, j * 16, 48, 48, 2699, 1, false, 0, false, false);
 				for (int num7 = 0; num7 < 3; num7++)
 				{
 					for (int num8 = 0; num8 < 3; num8++)
@@ -24364,7 +_,8 @@
 			if (flag)
 			{
 				WorldGen.destroyObject = true;
-				Item.NewItem(i * 16, j * 16, 32, 32, 498, 1, false, 0, false, false);
+				if (TileLoader.Drop(i,j,TileID.Mannequin, TileStyle.Style2x3))
+					Item.NewItem(i * 16, j * 16, 32, 32, 498, 1, false, 0, false, false);
 				for (int num5 = 0; num5 <= 1; num5++)
 				{
 					for (int num6 = 0; num6 <= 2; num6++)
@@ -24425,7 +_,8 @@
 			if (flag)
 			{
 				WorldGen.destroyObject = true;
-				Item.NewItem(i * 16, j * 16, 32, 32, 1989, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, TileID.Womannequin, TileStyle.Style2x3))
+					Item.NewItem(i * 16, j * 16, 32, 32, 1989, 1, false, 0, false, false);
 				for (int num5 = 0; num5 <= 1; num5++)
 				{
 					for (int num6 = 0; num6 <= 2; num6++)
@@ -24445,7 +_,7 @@
 		public static void Place1x2(int x, int y, ushort type, int style)
 		{
 			short frameX = 0;
-			if (type == 20)
+			if (TileLoader.IsSapling(type))
 			{
 				frameX = (short)(WorldGen.genRand.Next(3) * 18);
 			}
@@ -24547,134 +_,137 @@
 				{
 					WorldGen.KillTile(x, num2 + 1, false, false, false);
 				}
-				if (type == 42)
-				{
-					int type2 = 0;
-					if (num == 0)
-					{
-						type2 = 136;
-					}
-					else if (num == 7)
-					{
-						type2 = 1431;
-					}
-					else if (num == 8)
-					{
-						type2 = 1808;
-					}
-					else if (num == 9)
-					{
-						type2 = 1859;
-					}
-					else if (num < 10)
-					{
-						type2 = 1389 + num;
-					}
-					else if (num == 10)
-					{
-						type2 = 2032;
-					}
-					else if (num == 11)
-					{
-						type2 = 2033;
-					}
-					else if (num == 12)
-					{
-						type2 = 2034;
-					}
-					else if (num == 13)
-					{
-						type2 = 2035;
-					}
-					else if (num == 14)
-					{
-						type2 = 2036;
-					}
-					else if (num == 15)
-					{
-						type2 = 2037;
-					}
-					else if (num == 16)
-					{
-						type2 = 2038;
-					}
-					else if (num == 17)
-					{
-						type2 = 2039;
-					}
-					else if (num == 18)
-					{
-						type2 = 2040;
-					}
-					else if (num == 19)
-					{
-						type2 = 2041;
-					}
-					else if (num == 20)
-					{
-						type2 = 2042;
-					}
-					else if (num == 21)
-					{
-						type2 = 2043;
-					}
-					else if (num >= 22 && num <= 25)
-					{
-						type2 = 2145 + num - 22;
-					}
-					else if (num == 26)
-					{
-						type2 = 2226;
-					}
-					else if (num == 27)
-					{
-						type2 = 2530;
-					}
-					else if (num == 28)
-					{
-						type2 = 2546;
-					}
-					else if (num == 29)
-					{
-						type2 = 2564;
-					}
-					else if (num == 30)
-					{
-						type2 = 2579;
-					}
-					else if (num == 31)
-					{
-						type2 = 2641;
-					}
-					else if (num == 32)
-					{
-						type2 = 2642;
-					}
-					else if (num == 33)
-					{
-						type2 = 2820;
-					}
-					else if (num == 34)
-					{
-						type2 = 3138;
-					}
-					else if (num == 35)
-					{
-						type2 = 3140;
-					}
-					else if (num == 36)
-					{
-						type2 = 3139;
-					}
-					Item.NewItem(x * 16, num2 * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				else if (type == 270)
-				{
-					Item.NewItem(x * 16, num2 * 16, 32, 32, 1993, 1, false, 0, false, false);
-				}
-				else if (type == 271)
-				{
-					Item.NewItem(x * 16, num2 * 16, 32, 32, 2005, 1, false, 0, false, false);
+				if (TileLoader.Drop(x, num2, type, TileStyle.Style1x2))
+				{
+					if (type == 42)
+					{
+						int type2 = 0;
+						if (num == 0)
+						{
+							type2 = 136;
+						}
+						else if (num == 7)
+						{
+							type2 = 1431;
+						}
+						else if (num == 8)
+						{
+							type2 = 1808;
+						}
+						else if (num == 9)
+						{
+							type2 = 1859;
+						}
+						else if (num < 10)
+						{
+							type2 = 1389 + num;
+						}
+						else if (num == 10)
+						{
+							type2 = 2032;
+						}
+						else if (num == 11)
+						{
+							type2 = 2033;
+						}
+						else if (num == 12)
+						{
+							type2 = 2034;
+						}
+						else if (num == 13)
+						{
+							type2 = 2035;
+						}
+						else if (num == 14)
+						{
+							type2 = 2036;
+						}
+						else if (num == 15)
+						{
+							type2 = 2037;
+						}
+						else if (num == 16)
+						{
+							type2 = 2038;
+						}
+						else if (num == 17)
+						{
+							type2 = 2039;
+						}
+						else if (num == 18)
+						{
+							type2 = 2040;
+						}
+						else if (num == 19)
+						{
+							type2 = 2041;
+						}
+						else if (num == 20)
+						{
+							type2 = 2042;
+						}
+						else if (num == 21)
+						{
+							type2 = 2043;
+						}
+						else if (num >= 22 && num <= 25)
+						{
+							type2 = 2145 + num - 22;
+						}
+						else if (num == 26)
+						{
+							type2 = 2226;
+						}
+						else if (num == 27)
+						{
+							type2 = 2530;
+						}
+						else if (num == 28)
+						{
+							type2 = 2546;
+						}
+						else if (num == 29)
+						{
+							type2 = 2564;
+						}
+						else if (num == 30)
+						{
+							type2 = 2579;
+						}
+						else if (num == 31)
+						{
+							type2 = 2641;
+						}
+						else if (num == 32)
+						{
+							type2 = 2642;
+						}
+						else if (num == 33)
+						{
+							type2 = 2820;
+						}
+						else if (num == 34)
+						{
+							type2 = 3138;
+						}
+						else if (num == 35)
+						{
+							type2 = 3140;
+						}
+						else if (num == 36)
+						{
+							type2 = 3139;
+						}
+						Item.NewItem(x * 16, num2 * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					else if (type == 270)
+					{
+						Item.NewItem(x * 16, num2 * 16, 32, 32, 1993, 1, false, 0, false, false);
+					}
+					else if (type == 271)
+					{
+						Item.NewItem(x * 16, num2 * 16, 32, 32, 2005, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 			}
@@ -24845,250 +_,253 @@
 				{
 					WorldGen.KillTile(num3 + 1, y, false, false, false);
 				}
-				if (type == 16)
-				{
-					if (num2 == 1)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 716, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 35, 1, false, 0, false, false);
-					}
-				}
-				if (type == 18)
-				{
-					int type2 = 36;
-					if (num2 >= 1 && num2 <= 3)
-					{
-						type2 = 634 + num2;
-					}
-					else if (num2 >= 4 && num2 <= 8)
-					{
-						type2 = 807 + num2;
-					}
-					else if (num2 == 9)
-					{
-						type2 = 916;
-					}
-					else if (num2 == 10)
-					{
-						type2 = 1145;
-					}
-					else if (num2 == 11)
-					{
-						type2 = 1398;
-					}
-					else if (num2 == 12)
-					{
-						type2 = 1401;
-					}
-					else if (num2 == 13)
-					{
-						type2 = 1404;
-					}
-					else if (num2 == 14)
-					{
-						type2 = 1461;
-					}
-					else if (num2 == 15)
-					{
-						type2 = 1511;
-					}
-					else if (num2 == 16)
-					{
-						type2 = 1795;
-					}
-					else if (num2 == 17)
-					{
-						type2 = 1817;
-					}
-					else if (num2 == 18)
-					{
-						type2 = 2229;
-					}
-					else if (num2 == 19)
-					{
-						type2 = 2251;
-					}
-					else if (num2 == 20)
-					{
-						type2 = 2252;
-					}
-					else if (num2 == 21)
-					{
-						type2 = 2253;
-					}
-					else if (num2 == 22)
-					{
-						type2 = 2534;
-					}
-					else if (num2 == 23)
-					{
-						type2 = 673;
-					}
-					else if (num2 == 24)
-					{
-						type2 = 2631;
-					}
-					else if (num2 == 25)
-					{
-						type2 = 2632;
-					}
-					else if (num2 == 26)
-					{
-						type2 = 2633;
-					}
-					else if (num2 == 27)
-					{
-						type2 = 2826;
-					}
-					else if (num2 == 28)
-					{
-						type2 = 3156;
-					}
-					else if (num2 == 29)
-					{
-						type2 = 3158;
-					}
-					else if (num2 == 30)
-					{
-						type2 = 3157;
-					}
-					Item.NewItem(num3 * 16, y * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				if (type == 185)
-				{
-					if (frameX >= 576 && frameX <= 610)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						if (WorldGen.genRand.Next(3) != 0)
+				if (TileLoader.Drop(num3, y, type, TileStyle.Style2x1))
+				{
+					if (type == 16)
+					{
+						if (num2 == 1)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 716, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 35, 1, false, 0, false, false);
+						}
+					}
+					if (type == 18)
+					{
+						int type2 = 36;
+						if (num2 >= 1 && num2 <= 3)
+						{
+							type2 = 634 + num2;
+						}
+						else if (num2 >= 4 && num2 <= 8)
+						{
+							type2 = 807 + num2;
+						}
+						else if (num2 == 9)
+						{
+							type2 = 916;
+						}
+						else if (num2 == 10)
+						{
+							type2 = 1145;
+						}
+						else if (num2 == 11)
+						{
+							type2 = 1398;
+						}
+						else if (num2 == 12)
+						{
+							type2 = 1401;
+						}
+						else if (num2 == 13)
+						{
+							type2 = 1404;
+						}
+						else if (num2 == 14)
+						{
+							type2 = 1461;
+						}
+						else if (num2 == 15)
+						{
+							type2 = 1511;
+						}
+						else if (num2 == 16)
+						{
+							type2 = 1795;
+						}
+						else if (num2 == 17)
+						{
+							type2 = 1817;
+						}
+						else if (num2 == 18)
+						{
+							type2 = 2229;
+						}
+						else if (num2 == 19)
+						{
+							type2 = 2251;
+						}
+						else if (num2 == 20)
+						{
+							type2 = 2252;
+						}
+						else if (num2 == 21)
+						{
+							type2 = 2253;
+						}
+						else if (num2 == 22)
+						{
+							type2 = 2534;
+						}
+						else if (num2 == 23)
+						{
+							type2 = 673;
+						}
+						else if (num2 == 24)
+						{
+							type2 = 2631;
+						}
+						else if (num2 == 25)
+						{
+							type2 = 2632;
+						}
+						else if (num2 == 26)
+						{
+							type2 = 2633;
+						}
+						else if (num2 == 27)
+						{
+							type2 = 2826;
+						}
+						else if (num2 == 28)
+						{
+							type2 = 3156;
+						}
+						else if (num2 == 29)
+						{
+							type2 = 3158;
+						}
+						else if (num2 == 30)
+						{
+							type2 = 3157;
+						}
+						Item.NewItem(num3 * 16, y * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					if (type == 185)
+					{
+						if (frameX >= 576 && frameX <= 610)
 						{
 							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(3) != 0)
-						{
 							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(2) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(2) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(3) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(3) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(4) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(4) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(5) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(5) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-					}
-					if (frameX >= 612 && frameX <= 646)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-						if (WorldGen.genRand.Next(2) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(3) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-						}
-					}
-					if (frameX >= 648 && frameX <= 682)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(1, 6), false, 0, false, false);
-						if (WorldGen.genRand.Next(2) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(2, 6), false, 0, false, false);
-						}
-						if (WorldGen.genRand.Next(3) == 0)
-						{
-							Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(3, 6), false, 0, false, false);
-						}
-					}
-					if (frameX >= 684 && frameX <= 718)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 181, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-					if (frameX >= 720 && frameX <= 754)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 180, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-					if (frameX >= 756 && frameX <= 790)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 177, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-					if (frameX >= 792 && frameX <= 826)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 179, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-					if (frameX >= 828 && frameX <= 862)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 178, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-					if (frameX >= 864 && frameX <= 898)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 182, WorldGen.genRand.Next(1, 4), false, 0, false, false);
-					}
-				}
-				if (type == 462)
-				{
-					Item.NewItem(num3 * 16, y * 16, 32, 32, 3795, 1, false, 0, false, false);
-				}
-				if (type == 29)
-				{
-					Item.NewItem(num3 * 16, y * 16, 32, 32, 87, 1, false, 0, false, false);
-					Main.PlaySound(13, i * 16, y * 16, 1, 1f, 0f);
-				}
-				if (type == 103)
-				{
-					int type3 = 356;
-					if (num2 == 1)
-					{
-						type3 = 2235;
-					}
-					if (num2 == 2)
-					{
-						type3 = 2242;
-					}
-					if (num2 == 3)
-					{
-						type3 = 2243;
-					}
-					Item.NewItem(num3 * 16, y * 16, 32, 32, type3, 1, false, 0, false, false);
-					Main.PlaySound(13, i * 16, y * 16, 1, 1f, 0f);
-				}
-				else if (type == 134)
-				{
-					if (num2 == 1)
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 1220, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(num3 * 16, y * 16, 32, 32, 525, 1, false, 0, false, false);
+							if (WorldGen.genRand.Next(3) != 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(3) != 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(2) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(2) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(3) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(3) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(4) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(4) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(5) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(5) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+						}
+						if (frameX >= 612 && frameX <= 646)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+							if (WorldGen.genRand.Next(2) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(3) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 72, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+							}
+						}
+						if (frameX >= 648 && frameX <= 682)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(1, 6), false, 0, false, false);
+							if (WorldGen.genRand.Next(2) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(2, 6), false, 0, false, false);
+							}
+							if (WorldGen.genRand.Next(3) == 0)
+							{
+								Item.NewItem(num3 * 16, y * 16, 32, 32, 73, WorldGen.genRand.Next(3, 6), false, 0, false, false);
+							}
+						}
+						if (frameX >= 684 && frameX <= 718)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 181, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+						if (frameX >= 720 && frameX <= 754)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 180, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+						if (frameX >= 756 && frameX <= 790)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 177, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+						if (frameX >= 792 && frameX <= 826)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 179, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+						if (frameX >= 828 && frameX <= 862)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 178, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+						if (frameX >= 864 && frameX <= 898)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 182, WorldGen.genRand.Next(1, 4), false, 0, false, false);
+						}
+					}
+					if (type == 462)
+					{
+						Item.NewItem(num3 * 16, y * 16, 32, 32, 3795, 1, false, 0, false, false);
+					}
+					if (type == 29)
+					{
+						Item.NewItem(num3 * 16, y * 16, 32, 32, 87, 1, false, 0, false, false);
+						Main.PlaySound(13, i * 16, y * 16, 1, 1f, 0f);
+					}
+					if (type == 103)
+					{
+						int type3 = 356;
+						if (num2 == 1)
+						{
+							type3 = 2235;
+						}
+						if (num2 == 2)
+						{
+							type3 = 2242;
+						}
+						if (num2 == 3)
+						{
+							type3 = 2243;
+						}
+						Item.NewItem(num3 * 16, y * 16, 32, 32, type3, 1, false, 0, false, false);
+						Main.PlaySound(13, i * 16, y * 16, 1, 1f, 0f);
+					}
+					else if (type == 134)
+					{
+						if (num2 == 1)
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 1220, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(num3 * 16, y * 16, 32, 32, 525, 1, false, 0, false, false);
+						}
 					}
 				}
 				WorldGen.destroyObject = false;
@@ -25197,159 +_,162 @@
 						}
 					}
 				}
-				if (type == 79)
-				{
-					int type2;
-					if (num2 == 0)
-					{
-						type2 = 224;
-					}
-					else if (num2 == 4)
-					{
-						type2 = 920;
-					}
-					else if (num2 >= 9 && num2 <= 12)
-					{
-						type2 = 1710 + num2;
-					}
-					else if (num2 >= 5 && num2 <= 8)
-					{
-						type2 = 1465 + num2;
-					}
-					else if (num2 >= 13 && num2 <= 18)
-					{
-						type2 = 2066 + num2 - 13;
-					}
-					else if (num2 == 19)
-					{
-						type2 = 2139;
-					}
-					else if (num2 == 20)
-					{
-						type2 = 2140;
-					}
-					else if (num2 == 21)
-					{
-						type2 = 2231;
-					}
-					else if (num2 == 22)
-					{
-						type2 = 2520;
-					}
-					else if (num2 == 23)
-					{
-						type2 = 2538;
-					}
-					else if (num2 == 24)
-					{
-						type2 = 2553;
-					}
-					else if (num2 == 25)
-					{
-						type2 = 2568;
-					}
-					else if (num2 == 26)
-					{
-						type2 = 2669;
-					}
-					else if (num2 == 27)
-					{
-						type2 = 2811;
-					}
-					else if (num2 == 28)
-					{
-						type2 = 3162;
-					}
-					else if (num2 == 29)
-					{
-						type2 = 3164;
-					}
-					else if (num2 == 30)
-					{
-						type2 = 3163;
-					}
-					else
-					{
-						type2 = num2 + 643;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				if (type == 90)
-				{
-					int type3 = 0;
-					if (num2 == 0)
-					{
-						type3 = 336;
-					}
-					else if (num2 >= 1 && num2 <= 10)
-					{
-						type3 = 2072 + num2 - 1;
-					}
-					else if (num2 >= 11 && num2 <= 15)
-					{
-						type3 = 2124 + num2 - 11;
-					}
-					else if (num2 == 16)
-					{
-						type3 = 2232;
-					}
-					else if (num2 == 17)
-					{
-						type3 = 2519;
-					}
-					else if (num2 == 18)
-					{
-						type3 = 2537;
-					}
-					else if (num2 == 19)
-					{
-						type3 = 2552;
-					}
-					else if (num2 == 20)
-					{
-						type3 = 2567;
-					}
-					else if (num2 == 21)
-					{
-						type3 = 2658;
-					}
-					else if (num2 == 22)
-					{
-						type3 = 2659;
-					}
-					else if (num2 == 23)
-					{
-						type3 = 2660;
-					}
-					else if (num2 == 24)
-					{
-						type3 = 2661;
-					}
-					else if (num2 == 25)
-					{
-						type3 = 2662;
-					}
-					else if (num2 == 26)
-					{
-						type3 = 2663;
-					}
-					else if (num2 == 27)
-					{
-						type3 = 2810;
-					}
-					else if (num2 == 28)
-					{
-						type3 = 3159;
-					}
-					else if (num2 == 29)
-					{
-						type3 = 3161;
-					}
-					else if (num2 == 30)
-					{
-						type3 = 3160;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style4x2))
+				{
+					if (type == 79)
+					{
+						int type2;
+						if (num2 == 0)
+						{
+							type2 = 224;
+						}
+						else if (num2 == 4)
+						{
+							type2 = 920;
+						}
+						else if (num2 >= 9 && num2 <= 12)
+						{
+							type2 = 1710 + num2;
+						}
+						else if (num2 >= 5 && num2 <= 8)
+						{
+							type2 = 1465 + num2;
+						}
+						else if (num2 >= 13 && num2 <= 18)
+						{
+							type2 = 2066 + num2 - 13;
+						}
+						else if (num2 == 19)
+						{
+							type2 = 2139;
+						}
+						else if (num2 == 20)
+						{
+							type2 = 2140;
+						}
+						else if (num2 == 21)
+						{
+							type2 = 2231;
+						}
+						else if (num2 == 22)
+						{
+							type2 = 2520;
+						}
+						else if (num2 == 23)
+						{
+							type2 = 2538;
+						}
+						else if (num2 == 24)
+						{
+							type2 = 2553;
+						}
+						else if (num2 == 25)
+						{
+							type2 = 2568;
+						}
+						else if (num2 == 26)
+						{
+							type2 = 2669;
+						}
+						else if (num2 == 27)
+						{
+							type2 = 2811;
+						}
+						else if (num2 == 28)
+						{
+							type2 = 3162;
+						}
+						else if (num2 == 29)
+						{
+							type2 = 3164;
+						}
+						else if (num2 == 30)
+						{
+							type2 = 3163;
+						}
+						else
+						{
+							type2 = num2 + 643;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					if (type == 90)
+					{
+						int type3 = 0;
+						if (num2 == 0)
+						{
+							type3 = 336;
+						}
+						else if (num2 >= 1 && num2 <= 10)
+						{
+							type3 = 2072 + num2 - 1;
+						}
+						else if (num2 >= 11 && num2 <= 15)
+						{
+							type3 = 2124 + num2 - 11;
+						}
+						else if (num2 == 16)
+						{
+							type3 = 2232;
+						}
+						else if (num2 == 17)
+						{
+							type3 = 2519;
+						}
+						else if (num2 == 18)
+						{
+							type3 = 2537;
+						}
+						else if (num2 == 19)
+						{
+							type3 = 2552;
+						}
+						else if (num2 == 20)
+						{
+							type3 = 2567;
+						}
+						else if (num2 == 21)
+						{
+							type3 = 2658;
+						}
+						else if (num2 == 22)
+						{
+							type3 = 2659;
+						}
+						else if (num2 == 23)
+						{
+							type3 = 2660;
+						}
+						else if (num2 == 24)
+						{
+							type3 = 2661;
+						}
+						else if (num2 == 25)
+						{
+							type3 = 2662;
+						}
+						else if (num2 == 26)
+						{
+							type3 = 2663;
+						}
+						else if (num2 == 27)
+						{
+							type3 = 2810;
+						}
+						else if (num2 == 28)
+						{
+							type3 = 3159;
+						}
+						else if (num2 == 29)
+						{
+							type3 = 3161;
+						}
+						else if (num2 == 30)
+						{
+							type3 = 3160;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num5 = num - 1; num5 < num + 4; num5++)
@@ -25541,29 +_,32 @@
 				}
 				if (flag)
 				{
-					if (type == 238)
-					{
-						float num4 = (float)(i * 16);
-						float num5 = (float)(j * 16);
-						float num6 = -1f;
-						int plr = 0;
-						for (int num7 = 0; num7 < 255; num7++)
-						{
-							float num8 = Math.Abs(Main.player[num7].position.X - num4) + Math.Abs(Main.player[num7].position.Y - num5);
-							if (num8 < num6 || num6 == -1f)
-							{
-								plr = num7;
-								num6 = num8;
-							}
-						}
-						if (num6 / 16f < 50f)
-						{
-							NPC.SpawnOnPlayer(plr, 262);
-						}
-					}
-					if (type == 236)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 1291, 1, false, 0, false, false);
+					if (TileLoader.Drop(i, j, type, TileStyle.Empty)) // do not know the size for this
+					{
+						if (type == 238)
+						{
+							float num4 = (float)(i * 16);
+							float num5 = (float)(j * 16);
+							float num6 = -1f;
+							int plr = 0;
+							for (int num7 = 0; num7 < 255; num7++)
+							{
+								float num8 = Math.Abs(Main.player[num7].position.X - num4) + Math.Abs(Main.player[num7].position.Y - num5);
+								if (num8 < num6 || num6 == -1f)
+								{
+									plr = num7;
+									num6 = num8;
+								}
+							}
+							if (num6 / 16f < 50f)
+							{
+								NPC.SpawnOnPlayer(plr, 262);
+							}
+						}
+						if (type == 236)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 1291, 1, false, 0, false, false);
+						}
 					}
 					short arg_2A9_0 = Main.tile[i, j].frameX;
 					WorldGen.destroyObject = true;
@@ -25807,9 +_,15 @@
 			{
 				Projectile.NewProjectile((float)(num2 * 16 + 16), (float)(num3 * 16 + 16), 0f, 0f, 655, 0, 0f, Main.myPlayer, 0f, 0f);
 			}
-			if (num12 != 0)
-			{
-				Item.NewItem(num2 * 16, num3 * 16, tileData.CoordinateFullWidth, tileData.CoordinateFullHeight, num12, 1, false, 0, false, false);
+			//FishingCrate, GeyserTrap, and BeeHive
+			// geyser is 2x1
+			TileStyle tileDrop = num12 == 3722 ? TileStyle.Style1x2 : TileStyle.Style2x2;
+			if (TileLoader.Drop(num2, num3, type, tileDrop))
+			{
+				if (num12 != 0)
+				{
+					Item.NewItem(num2 * 16, num3 * 16, tileData.CoordinateFullWidth, tileData.CoordinateFullHeight, num12, 1, false, 0, false, false);
+				}
 			}
 			WorldGen.destroyObject = false;
 			for (int num13 = -1; num13 < width + 1; num13++)
@@ -25880,7 +_,7 @@
 			{
 				ushort type2 = Main.tile[k, num4 - 1].type;
 				ushort type3 = Main.tile[k + 1, num4 - 1].type;
-				if (type2 != 21 && type3 != 21 && type2 != 88 && type3 != 88 && type2 != 441 && type3 != 441 && !WorldGen.SolidTileAllowBottomSlope(k, num4 + 2) && !WorldGen.SolidTileAllowBottomSlope(k + 1, num4 + 2))
+				if (!TileLoader.IsChest(type2) && !TileLoader.IsChest(type3) && !TileLoader.IsDresser(type2) && !TileLoader.IsDresser(type3) && type2 != 441 && type3 != 441 && !WorldGen.SolidTileAllowBottomSlope(k, num4 + 2) && !WorldGen.SolidTileAllowBottomSlope(k + 1, num4 + 2))
 				{
 					flag = true;
 				}
@@ -26148,9 +_,12 @@
 					num13 = 3148;
 				}
 			}
-			if (num13 != 0)
-			{
-				Item.NewItem(i * 16, j * 16, 32, 32, num13, 1, false, 0, false, false);
+			if (TileLoader.Drop(i, j, type, TileStyle.Style2x2))
+			{
+				if (num13 != 0)
+				{
+					Item.NewItem(i * 16, j * 16, 32, 32, num13, 1, false, 0, false, false);
+				}
 			}
 			if (type == 138 && !WorldGen.gen && Main.netMode != 1)
 			{
@@ -26179,7 +_,7 @@
 			{
 			}
 			k = j - k / 18;
-			return Main.tile[num, k - 1].type == 21 || Main.tile[num + 1, k - 1].type == 21 || Main.tile[num, k - 1].type == 441 || Main.tile[num + 1, k - 1].type == 441 || Main.tile[num, k - 1].type == 88 || Main.tile[num + 1, k - 1].type == 88;
+			return TileLoader.IsChest(Main.tile[num, k - 1].type) || TileLoader.IsChest(Main.tile[num + 1, k - 1].type) || Main.tile[num, k - 1].type == 441 || Main.tile[num + 1, k - 1].type == 441 || TileLoader.IsDresser(Main.tile[num, k - 1].type) || TileLoader.IsDresser(Main.tile[num + 1, k - 1].type);
 		}
 
 		public static void OreRunner(int i, int j, double strength, int steps, ushort type)
@@ -26438,7 +_,7 @@
 				{
 					flag = true;
 				}
-				if (Main.tile[l, j - 1].active() && (Main.tile[l, j - 1].type == 21 || Main.tile[l, j - 1].type == 441 || Main.tile[l, j - 1].type == 88))
+				if (Main.tile[l, j - 1].active() && (TileLoader.IsChest(Main.tile[l, j - 1].type) || Main.tile[l, j - 1].type == 441 || TileLoader.IsDresser(Main.tile[l, j - 1].type)))
 				{
 					return;
 				}
@@ -26451,9 +_,12 @@
 			{
 				short arg_162_0 = Main.tile[i, j].frameX;
 				WorldGen.destroyObject = true;
-				if (type == 235)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1263, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style3x1))
+				{
+					if (type == 235)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1263, 1, false, 0, false, false);
+					}
 				}
 				for (int m = k; m < k + 3; m++)
 				{
@@ -26573,548 +_,551 @@
 						}
 					}
 				}
-				if (type == 14)
-				{
-					int type2;
-					if (num5 >= 1 && num5 <= 3)
-					{
-						type2 = 637 + num5;
-					}
-					else if (num5 >= 15 && num5 <= 20)
-					{
-						type2 = 1698 + num5;
-					}
-					else if (num5 >= 4 && num5 <= 7)
-					{
-						type2 = 823 + num5;
-					}
-					else if (num5 == 8)
-					{
-						type2 = 917;
-					}
-					else if (num5 == 9)
-					{
-						type2 = 1144;
-					}
-					else if (num5 == 10)
-					{
-						type2 = 1397;
-					}
-					else if (num5 == 11)
-					{
-						type2 = 1400;
-					}
-					else if (num5 == 12)
-					{
-						type2 = 1403;
-					}
-					else if (num5 == 13)
-					{
-						type2 = 1460;
-					}
-					else if (num5 == 14)
-					{
-						type2 = 1510;
-					}
-					else if (num5 == 23)
-					{
-						type2 = 1926;
-					}
-					else if (num5 == 21)
-					{
-						type2 = 1794;
-					}
-					else if (num5 == 22)
-					{
-						type2 = 1816;
-					}
-					else if (num5 == 24)
-					{
-						type2 = 2248;
-					}
-					else if (num5 == 25)
-					{
-						type2 = 2259;
-					}
-					else if (num5 == 26)
-					{
-						type2 = 2532;
-					}
-					else if (num5 == 27)
-					{
-						type2 = 2550;
-					}
-					else if (num5 == 28)
-					{
-						type2 = 677;
-					}
-					else if (num5 == 29)
-					{
-						type2 = 2583;
-					}
-					else if (num5 == 30)
-					{
-						type2 = 2743;
-					}
-					else if (num5 == 31)
-					{
-						type2 = 2824;
-					}
-					else if (num5 == 32)
-					{
-						type2 = 3153;
-					}
-					else if (num5 == 33)
-					{
-						type2 = 3155;
-					}
-					else if (num5 == 34)
-					{
-						type2 = 3154;
-					}
-					else
-					{
-						type2 = 32;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				else if (type == 114)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 398, 1, false, 0, false, false);
-				}
-				else if (type == 26)
-				{
-					if (!WorldGen.noTileActions && !WorldGen.IsGeneratingHardMode)
-					{
-						WorldGen.SmashAltar(i, j);
-					}
-				}
-				else if (type == 298)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2190, 1, false, 0, false, false);
-				}
-				else if (type == 299)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2191, 1, false, 0, false, false);
-				}
-				else if (type >= 361 && type <= 364)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3073 + type - 361, 1, false, 0, false, false);
-				}
-				else if (type >= 391 && type <= 394)
-				{
-					Item.NewItem(i * 16, j * 16, 48, 32, 3254 + type - 391, 1, false, 0, false, false);
-				}
-				else if (type == 285)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2174, 1, false, 0, false, false);
-				}
-				else if (type == 286)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2175, 1, false, 0, false, false);
-				}
-				else if (type == 310)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2207, 1, false, 0, false, false);
-				}
-				else if (type == 339)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2741, 1, false, 0, false, false);
-				}
-				else if (type == 217)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 995, 1, false, 0, false, false);
-				}
-				else if (type == 218)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 996, 1, false, 0, false, false);
-				}
-				else if (type == 219)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 997, 1, false, 0, false, false);
-				}
-				else if (type == 220)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 998, 1, false, 0, false, false);
-				}
-				else if (type == 377)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3198, 1, false, 0, false, false);
-				}
-				else if (type == 228)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1120, 1, false, 0, false, false);
-				}
-				else if (type == 405)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3364, 1, false, 0, false, false);
-				}
-				else if (type == 215)
-				{
-					if (num5 == 0)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 966, 1, false, 0, false, false);
-					}
-					else if (num5 == 6)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 3723, 1, false, 0, false, false);
-					}
-					else if (num5 == 7)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 3724, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 3046 + num5 - 1, 1, false, 0, false, false);
-					}
-				}
-				else if (type == 244)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1449, 1, false, 0, false, false);
-				}
-				else if (type == 17)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 33, 1, false, 0, false, false);
-				}
-				else if (type == 77)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 221, 1, false, 0, false, false);
-				}
-				else if (type == 86)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 332, 1, false, 0, false, false);
-				}
-				else if (type == 237)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1292, 1, false, 0, false, false);
-				}
-				else if (type == 87)
-				{
-					int type3;
-					if (num5 >= 1 && num5 <= 3)
-					{
-						type3 = 640 + num5;
-					}
-					else if (num5 == 4)
-					{
-						type3 = 919;
-					}
-					else if (num5 >= 5 && num5 <= 7)
-					{
-						type3 = 2245 + num5 - 5;
-					}
-					else if (num5 >= 8 && num5 <= 10)
-					{
-						type3 = 2254 + num5 - 8;
-					}
-					else if (num5 >= 11 && num5 <= 20)
-					{
-						type3 = 2376 + num5 - 11;
-					}
-					else if (num5 == 21)
-					{
-						type3 = 2531;
-					}
-					else if (num5 == 22)
-					{
-						type3 = 2548;
-					}
-					else if (num5 == 23)
-					{
-						type3 = 2565;
-					}
-					else if (num5 == 24)
-					{
-						type3 = 2580;
-					}
-					else if (num5 == 25)
-					{
-						type3 = 2671;
-					}
-					else if (num5 == 26)
-					{
-						type3 = 2821;
-					}
-					else if (num5 == 27)
-					{
-						type3 = 3141;
-					}
-					else if (num5 == 28)
-					{
-						type3 = 3143;
-					}
-					else if (num5 == 29)
-					{
-						type3 = 3142;
-					}
-					else
-					{
-						type3 = 333;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
-				}
-				else if (type == 88)
-				{
-					int type4;
-					if (num5 >= 1 && num5 <= 3)
-					{
-						type4 = 646 + num5;
-					}
-					else if (num5 == 4)
-					{
-						type4 = 918;
-					}
-					else if (num5 >= 5 && num5 <= 15)
-					{
-						type4 = 2386 + num5 - 5;
-					}
-					else if (num5 == 16)
-					{
-						type4 = 2529;
-					}
-					else if (num5 == 17)
-					{
-						type4 = 2545;
-					}
-					else if (num5 == 18)
-					{
-						type4 = 2562;
-					}
-					else if (num5 == 19)
-					{
-						type4 = 2577;
-					}
-					else if (num5 == 20)
-					{
-						type4 = 2637;
-					}
-					else if (num5 == 21)
-					{
-						type4 = 2638;
-					}
-					else if (num5 == 22)
-					{
-						type4 = 2639;
-					}
-					else if (num5 == 23)
-					{
-						type4 = 2640;
-					}
-					else if (num5 == 24)
-					{
-						type4 = 2816;
-					}
-					else if (num5 == 25)
-					{
-						type4 = 3132;
-					}
-					else if (num5 == 26)
-					{
-						type4 = 3134;
-					}
-					else if (num5 == 27)
-					{
-						type4 = 3133;
-					}
-					else
-					{
-						type4 = 334;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type4, 1, false, 0, false, false);
-				}
-				else if (type == 89)
-				{
-					int type5;
-					if (num5 >= 1 && num5 <= 20)
-					{
-						type5 = 2397 + num5 - 1;
-					}
-					else if (num5 == 21)
-					{
-						type5 = 2521;
-					}
-					else if (num5 == 22)
-					{
-						type5 = 2527;
-					}
-					else if (num5 == 23)
-					{
-						type5 = 2539;
-					}
-					else if (num5 == 24)
-					{
-						type5 = 858;
-					}
-					else if (num5 == 25)
-					{
-						type5 = 2582;
-					}
-					else if (num5 == 26)
-					{
-						type5 = 2634;
-					}
-					else if (num5 == 27)
-					{
-						type5 = 2635;
-					}
-					else if (num5 == 28)
-					{
-						type5 = 2636;
-					}
-					else if (num5 == 29)
-					{
-						type5 = 2823;
-					}
-					else if (num5 == 30)
-					{
-						type5 = 3150;
-					}
-					else if (num5 == 31)
-					{
-						type5 = 3152;
-					}
-					else if (num5 == 32)
-					{
-						type5 = 3151;
-					}
-					else
-					{
-						type5 = 335;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type5, 1, false, 0, false, false);
-				}
-				else if (type == 133)
-				{
-					if (frameX >= 54)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 1221, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 524, 1, false, 0, false, false);
-					}
-				}
-				else if (type == 186)
-				{
-					if (frameX >= 864)
-					{
-						if (frameX <= 954)
-						{
-							Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							if (WorldGen.genRand.Next(3) != 0)
+				if (TileLoader.Drop(i, j, type, TileStyle.Style3x2))
+				{
+					if (type == 14)
+					{
+						int type2;
+						if (num5 >= 1 && num5 <= 3)
+						{
+							type2 = 637 + num5;
+						}
+						else if (num5 >= 15 && num5 <= 20)
+						{
+							type2 = 1698 + num5;
+						}
+						else if (num5 >= 4 && num5 <= 7)
+						{
+							type2 = 823 + num5;
+						}
+						else if (num5 == 8)
+						{
+							type2 = 917;
+						}
+						else if (num5 == 9)
+						{
+							type2 = 1144;
+						}
+						else if (num5 == 10)
+						{
+							type2 = 1397;
+						}
+						else if (num5 == 11)
+						{
+							type2 = 1400;
+						}
+						else if (num5 == 12)
+						{
+							type2 = 1403;
+						}
+						else if (num5 == 13)
+						{
+							type2 = 1460;
+						}
+						else if (num5 == 14)
+						{
+							type2 = 1510;
+						}
+						else if (num5 == 23)
+						{
+							type2 = 1926;
+						}
+						else if (num5 == 21)
+						{
+							type2 = 1794;
+						}
+						else if (num5 == 22)
+						{
+							type2 = 1816;
+						}
+						else if (num5 == 24)
+						{
+							type2 = 2248;
+						}
+						else if (num5 == 25)
+						{
+							type2 = 2259;
+						}
+						else if (num5 == 26)
+						{
+							type2 = 2532;
+						}
+						else if (num5 == 27)
+						{
+							type2 = 2550;
+						}
+						else if (num5 == 28)
+						{
+							type2 = 677;
+						}
+						else if (num5 == 29)
+						{
+							type2 = 2583;
+						}
+						else if (num5 == 30)
+						{
+							type2 = 2743;
+						}
+						else if (num5 == 31)
+						{
+							type2 = 2824;
+						}
+						else if (num5 == 32)
+						{
+							type2 = 3153;
+						}
+						else if (num5 == 33)
+						{
+							type2 = 3155;
+						}
+						else if (num5 == 34)
+						{
+							type2 = 3154;
+						}
+						else
+						{
+							type2 = 32;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					else if (type == 114)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 398, 1, false, 0, false, false);
+					}
+					else if (type == 26)
+					{
+						if (!WorldGen.noTileActions && !WorldGen.IsGeneratingHardMode)
+						{
+							WorldGen.SmashAltar(i, j);
+						}
+					}
+					else if (type == 298)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2190, 1, false, 0, false, false);
+					}
+					else if (type == 299)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2191, 1, false, 0, false, false);
+					}
+					else if (type >= 361 && type <= 364)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3073 + type - 361, 1, false, 0, false, false);
+					}
+					else if (type >= 391 && type <= 394)
+					{
+						Item.NewItem(i * 16, j * 16, 48, 32, 3254 + type - 391, 1, false, 0, false, false);
+					}
+					else if (type == 285)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2174, 1, false, 0, false, false);
+					}
+					else if (type == 286)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2175, 1, false, 0, false, false);
+					}
+					else if (type == 310)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2207, 1, false, 0, false, false);
+					}
+					else if (type == 339)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2741, 1, false, 0, false, false);
+					}
+					else if (type == 217)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 995, 1, false, 0, false, false);
+					}
+					else if (type == 218)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 996, 1, false, 0, false, false);
+					}
+					else if (type == 219)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 997, 1, false, 0, false, false);
+					}
+					else if (type == 220)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 998, 1, false, 0, false, false);
+					}
+					else if (type == 377)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3198, 1, false, 0, false, false);
+					}
+					else if (type == 228)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1120, 1, false, 0, false, false);
+					}
+					else if (type == 405)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3364, 1, false, 0, false, false);
+					}
+					else if (type == 215)
+					{
+						if (num5 == 0)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 966, 1, false, 0, false, false);
+						}
+						else if (num5 == 6)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 3723, 1, false, 0, false, false);
+						}
+						else if (num5 == 7)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 3724, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 3046 + num5 - 1, 1, false, 0, false, false);
+						}
+					}
+					else if (type == 244)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1449, 1, false, 0, false, false);
+					}
+					else if (type == 17)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 33, 1, false, 0, false, false);
+					}
+					else if (type == 77)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 221, 1, false, 0, false, false);
+					}
+					else if (type == 86)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 332, 1, false, 0, false, false);
+					}
+					else if (type == 237)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1292, 1, false, 0, false, false);
+					}
+					else if (type == 87)
+					{
+						int type3;
+						if (num5 >= 1 && num5 <= 3)
+						{
+							type3 = 640 + num5;
+						}
+						else if (num5 == 4)
+						{
+							type3 = 919;
+						}
+						else if (num5 >= 5 && num5 <= 7)
+						{
+							type3 = 2245 + num5 - 5;
+						}
+						else if (num5 >= 8 && num5 <= 10)
+						{
+							type3 = 2254 + num5 - 8;
+						}
+						else if (num5 >= 11 && num5 <= 20)
+						{
+							type3 = 2376 + num5 - 11;
+						}
+						else if (num5 == 21)
+						{
+							type3 = 2531;
+						}
+						else if (num5 == 22)
+						{
+							type3 = 2548;
+						}
+						else if (num5 == 23)
+						{
+							type3 = 2565;
+						}
+						else if (num5 == 24)
+						{
+							type3 = 2580;
+						}
+						else if (num5 == 25)
+						{
+							type3 = 2671;
+						}
+						else if (num5 == 26)
+						{
+							type3 = 2821;
+						}
+						else if (num5 == 27)
+						{
+							type3 = 3141;
+						}
+						else if (num5 == 28)
+						{
+							type3 = 3143;
+						}
+						else if (num5 == 29)
+						{
+							type3 = 3142;
+						}
+						else
+						{
+							type3 = 333;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type3, 1, false, 0, false, false);
+					}
+					else if (type == 88)
+					{
+						int type4;
+						if (num5 >= 1 && num5 <= 3)
+						{
+							type4 = 646 + num5;
+						}
+						else if (num5 == 4)
+						{
+							type4 = 918;
+						}
+						else if (num5 >= 5 && num5 <= 15)
+						{
+							type4 = 2386 + num5 - 5;
+						}
+						else if (num5 == 16)
+						{
+							type4 = 2529;
+						}
+						else if (num5 == 17)
+						{
+							type4 = 2545;
+						}
+						else if (num5 == 18)
+						{
+							type4 = 2562;
+						}
+						else if (num5 == 19)
+						{
+							type4 = 2577;
+						}
+						else if (num5 == 20)
+						{
+							type4 = 2637;
+						}
+						else if (num5 == 21)
+						{
+							type4 = 2638;
+						}
+						else if (num5 == 22)
+						{
+							type4 = 2639;
+						}
+						else if (num5 == 23)
+						{
+							type4 = 2640;
+						}
+						else if (num5 == 24)
+						{
+							type4 = 2816;
+						}
+						else if (num5 == 25)
+						{
+							type4 = 3132;
+						}
+						else if (num5 == 26)
+						{
+							type4 = 3134;
+						}
+						else if (num5 == 27)
+						{
+							type4 = 3133;
+						}
+						else
+						{
+							type4 = 334;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type4, 1, false, 0, false, false);
+					}
+					else if (type == 89)
+					{
+						int type5;
+						if (num5 >= 1 && num5 <= 20)
+						{
+							type5 = 2397 + num5 - 1;
+						}
+						else if (num5 == 21)
+						{
+							type5 = 2521;
+						}
+						else if (num5 == 22)
+						{
+							type5 = 2527;
+						}
+						else if (num5 == 23)
+						{
+							type5 = 2539;
+						}
+						else if (num5 == 24)
+						{
+							type5 = 858;
+						}
+						else if (num5 == 25)
+						{
+							type5 = 2582;
+						}
+						else if (num5 == 26)
+						{
+							type5 = 2634;
+						}
+						else if (num5 == 27)
+						{
+							type5 = 2635;
+						}
+						else if (num5 == 28)
+						{
+							type5 = 2636;
+						}
+						else if (num5 == 29)
+						{
+							type5 = 2823;
+						}
+						else if (num5 == 30)
+						{
+							type5 = 3150;
+						}
+						else if (num5 == 31)
+						{
+							type5 = 3152;
+						}
+						else if (num5 == 32)
+						{
+							type5 = 3151;
+						}
+						else
+						{
+							type5 = 335;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type5, 1, false, 0, false, false);
+					}
+					else if (type == 133)
+					{
+						if (frameX >= 54)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 1221, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 524, 1, false, 0, false, false);
+						}
+					}
+					else if (type == 186)
+					{
+						if (frameX >= 864)
+						{
+							if (frameX <= 954)
 							{
 								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) != 0)
-							{
 								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) != 0)
-							{
 								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(4) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(4) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(4) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(5) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(5) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(5) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-						}
-						else if (frameX <= 1062)
-						{
-							Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(10, 100), false, 0, false, false);
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(20, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(30, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(4) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(40, 100), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(5) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(50, 100), false, 0, false, false);
-							}
-						}
-						else if (frameX <= 1170)
-						{
-							Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(1, 7), false, 0, false, false);
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(2, 7), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(3) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(3, 7), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(4) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(4, 7), false, 0, false, false);
-							}
-							if (WorldGen.genRand.Next(5) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(5, 7), false, 0, false, false);
-							}
-						}
-					}
-				}
-				else if (type == 187 && frameX >= 918 && frameX <= 970)
-				{
-					if (Main.rand.Next(10) == 0)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 3368, 1, false, 0, false, false);
-					}
-					else
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 989, 1, false, 0, false, false);
+								if (WorldGen.genRand.Next(3) != 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) != 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) != 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(4) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(4) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(4) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(5) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(5) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(5) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 71, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+							}
+							else if (frameX <= 1062)
+							{
+								Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(10, 100), false, 0, false, false);
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(20, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(30, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(4) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(40, 100), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(5) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 72, WorldGen.genRand.Next(50, 100), false, 0, false, false);
+								}
+							}
+							else if (frameX <= 1170)
+							{
+								Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(1, 7), false, 0, false, false);
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(2, 7), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(3) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(3, 7), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(4) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(4, 7), false, 0, false, false);
+								}
+								if (WorldGen.genRand.Next(5) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, WorldGen.genRand.Next(5, 7), false, 0, false, false);
+								}
+							}
+						}
+					}
+					else if (type == 187 && frameX >= 918 && frameX <= 970)
+					{
+						if (Main.rand.Next(10) == 0)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 3368, 1, false, 0, false, false);
+						}
+						else
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 989, 1, false, 0, false, false);
+						}
 					}
 				}
 				WorldGen.destroyObject = false;
@@ -27178,134 +_,137 @@
 						}
 					}
 				}
-				if (type == 101)
-				{
-					int type2;
-					if (num == 1)
-					{
-						type2 = 1414;
-					}
-					else if (num == 2)
-					{
-						type2 = 1415;
-					}
-					else if (num == 3)
-					{
-						type2 = 1416;
-					}
-					else if (num == 4)
-					{
-						type2 = 1463;
-					}
-					else if (num == 5)
-					{
-						type2 = 1512;
-					}
-					else if (num == 6)
-					{
-						type2 = 2020;
-					}
-					else if (num == 7)
-					{
-						type2 = 2021;
-					}
-					else if (num == 8)
-					{
-						type2 = 2022;
-					}
-					else if (num == 9)
-					{
-						type2 = 2023;
-					}
-					else if (num == 10)
-					{
-						type2 = 2024;
-					}
-					else if (num == 11)
-					{
-						type2 = 2025;
-					}
-					else if (num == 12)
-					{
-						type2 = 2026;
-					}
-					else if (num == 13)
-					{
-						type2 = 2027;
-					}
-					else if (num == 14)
-					{
-						type2 = 2028;
-					}
-					else if (num == 15)
-					{
-						type2 = 2029;
-					}
-					else if (num == 16)
-					{
-						type2 = 2030;
-					}
-					else if (num == 17)
-					{
-						type2 = 2031;
-					}
-					else if (num >= 18 && num <= 21)
-					{
-						type2 = 2135 + num - 18;
-					}
-					else if (num == 22)
-					{
-						type2 = 2233;
-					}
-					else if (num == 23)
-					{
-						type2 = 2536;
-					}
-					else if (num == 24)
-					{
-						type2 = 2540;
-					}
-					else if (num == 25)
-					{
-						type2 = 2554;
-					}
-					else if (num == 26)
-					{
-						type2 = 2569;
-					}
-					else if (num == 27)
-					{
-						type2 = 2670;
-					}
-					else if (num == 28)
-					{
-						type2 = 2817;
-					}
-					else if (num == 29)
-					{
-						type2 = 3165;
-					}
-					else if (num == 30)
-					{
-						type2 = 3167;
-					}
-					else if (num == 31)
-					{
-						type2 = 3166;
-					}
-					else
-					{
-						type2 = 354;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
-				}
-				else if (type == 102)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 355, 1, false, 0, false, false);
-				}
-				else if (type == 463)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3813, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style3x4))
+				{
+					if (type == 101)
+					{
+						int type2;
+						if (num == 1)
+						{
+							type2 = 1414;
+						}
+						else if (num == 2)
+						{
+							type2 = 1415;
+						}
+						else if (num == 3)
+						{
+							type2 = 1416;
+						}
+						else if (num == 4)
+						{
+							type2 = 1463;
+						}
+						else if (num == 5)
+						{
+							type2 = 1512;
+						}
+						else if (num == 6)
+						{
+							type2 = 2020;
+						}
+						else if (num == 7)
+						{
+							type2 = 2021;
+						}
+						else if (num == 8)
+						{
+							type2 = 2022;
+						}
+						else if (num == 9)
+						{
+							type2 = 2023;
+						}
+						else if (num == 10)
+						{
+							type2 = 2024;
+						}
+						else if (num == 11)
+						{
+							type2 = 2025;
+						}
+						else if (num == 12)
+						{
+							type2 = 2026;
+						}
+						else if (num == 13)
+						{
+							type2 = 2027;
+						}
+						else if (num == 14)
+						{
+							type2 = 2028;
+						}
+						else if (num == 15)
+						{
+							type2 = 2029;
+						}
+						else if (num == 16)
+						{
+							type2 = 2030;
+						}
+						else if (num == 17)
+						{
+							type2 = 2031;
+						}
+						else if (num >= 18 && num <= 21)
+						{
+							type2 = 2135 + num - 18;
+						}
+						else if (num == 22)
+						{
+							type2 = 2233;
+						}
+						else if (num == 23)
+						{
+							type2 = 2536;
+						}
+						else if (num == 24)
+						{
+							type2 = 2540;
+						}
+						else if (num == 25)
+						{
+							type2 = 2554;
+						}
+						else if (num == 26)
+						{
+							type2 = 2569;
+						}
+						else if (num == 27)
+						{
+							type2 = 2670;
+						}
+						else if (num == 28)
+						{
+							type2 = 2817;
+						}
+						else if (num == 29)
+						{
+							type2 = 3165;
+						}
+						else if (num == 30)
+						{
+							type2 = 3167;
+						}
+						else if (num == 31)
+						{
+							type2 = 3166;
+						}
+						else
+						{
+							type2 = 354;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
+					else if (type == 102)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 355, 1, false, 0, false, false);
+					}
+					else if (type == 463)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3813, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num5 = num2 - 1; num5 < num2 + 4; num5++)
@@ -27368,13 +_,16 @@
 						}
 					}
 				}
-				if (type == 464)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3814, 1, false, 0, false, false);
-				}
-				if (type == 466)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3816, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style5x4))
+				{
+					if (type == 464)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3814, 1, false, 0, false, false);
+					}
+					if (type == 466)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3816, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num5 = num2 - 1; num5 < num2 + 6; num5++)
@@ -27432,61 +_,64 @@
 						}
 					}
 				}
-				if (type == 275)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2162, 1, false, 0, false, false);
-				}
-				if (type == 413)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3565, 1, false, 0, false, false);
-				}
-				if (type == 414)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3566, 1, false, 0, false, false);
-				}
-				if (type == 276)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2163, 1, false, 0, false, false);
-				}
-				if (type == 277)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2164, 1, false, 0, false, false);
-				}
-				if (type == 278)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2165, 1, false, 0, false, false);
-				}
-				if (type == 279)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2166, 1, false, 0, false, false);
-				}
-				if (type == 280)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2167, 1, false, 0, false, false);
-				}
-				if (type == 281)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2168, 1, false, 0, false, false);
-				}
-				if (type == 296)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2186, 1, false, 0, false, false);
-				}
-				if (type == 297)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2187, 1, false, 0, false, false);
-				}
-				if (type == 309)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2206, 1, false, 0, false, false);
-				}
-				if (type == 358)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3070, 1, false, 0, false, false);
-				}
-				if (type == 359)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3071, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style6x3))
+				{
+					if (type == 275)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2162, 1, false, 0, false, false);
+					}
+					if (type == 413)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3565, 1, false, 0, false, false);
+					}
+					if (type == 414)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3566, 1, false, 0, false, false);
+					}
+					if (type == 276)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2163, 1, false, 0, false, false);
+					}
+					if (type == 277)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2164, 1, false, 0, false, false);
+					}
+					if (type == 278)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2165, 1, false, 0, false, false);
+					}
+					if (type == 279)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2166, 1, false, 0, false, false);
+					}
+					if (type == 280)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2167, 1, false, 0, false, false);
+					}
+					if (type == 281)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2168, 1, false, 0, false, false);
+					}
+					if (type == 296)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2186, 1, false, 0, false, false);
+					}
+					if (type == 297)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2187, 1, false, 0, false, false);
+					}
+					if (type == 309)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2206, 1, false, 0, false, false);
+					}
+					if (type == 358)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3070, 1, false, 0, false, false);
+					}
+					if (type == 359)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3071, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num4 = num - 1; num4 < num + 7; num4++)
@@ -27825,21 +_,24 @@
 						}
 					}
 				}
-				int type2 = 928;
-				switch (num)
-				{
-					case 1:
-						type2 = 1337;
-						break;
-					case 2:
-						type2 = 3369;
-						break;
-					case 3:
-					case 4:
-						type2 = 3664;
-						break;
-				}
-				Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style4x3))
+				{
+					int type2 = 928;
+					switch (num)
+					{
+						case 1:
+							type2 = 1337;
+							break;
+						case 2:
+							type2 = 3369;
+							break;
+						case 3:
+						case 4:
+							type2 = 3664;
+							break;
+					}
+					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+				}
 				WorldGen.destroyObject = false;
 				for (int num7 = k; num7 < k + 4; num7++)
 				{
@@ -27956,7 +_,8 @@
 					{
 						Main.tile[l, m] = new Tile();
 					}
-					if (Main.tile[l, m].active() && (Main.tile[l, m].type == 139 || Main.tile[l, m].type == 35))
+					if (Main.tile[l, m].active() && (Main.tile[l, m].type == 139 || Main.tile[l, m].type == 35
+						|| TileLoader.IsModMusicBox(Main.tile[l, m])))
 					{
 						if (Main.tile[l, m].frameX < 36)
 						{
@@ -28136,65 +_,69 @@
 						}
 					}
 				}
-				if (type == 35)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1813, 1, false, 0, false, false);
-				}
-				else if (num == 28)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1963, 1, false, 0, false, false);
-				}
-				else if (num == 29)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1964, 1, false, 0, false, false);
-				}
-				else if (num == 30)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1965, 1, false, 0, false, false);
-				}
-				else if (num == 31)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2742, 1, false, 0, false, false);
-				}
-				else if (num == 32)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3044, 1, false, 0, false, false);
-				}
-				else if (num == 33)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3235, 1, false, 0, false, false);
-				}
-				else if (num == 34)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3236, 1, false, 0, false, false);
-				}
-				else if (num == 35)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3237, 1, false, 0, false, false);
-				}
-				else if (num == 36)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3370, 1, false, 0, false, false);
-				}
-				else if (num == 37)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3371, 1, false, 0, false, false);
-				}
-				else if (num == 38)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3796, 1, false, 0, false, false);
-				}
-				else if (num == 39)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3869, 1, false, 0, false, false);
-				}
-				else if (num >= 13)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1596 + num - 13, 1, false, 0, false, false);
-				}
-				else
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 562 + num, 1, false, 0, false, false);
+				// size ???
+				if (TileLoader.Drop(i, j, type, TileStyle.Empty))
+				{
+					if (type == 35)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1813, 1, false, 0, false, false);
+					}
+					else if (num == 28)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1963, 1, false, 0, false, false);
+					}
+					else if (num == 29)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1964, 1, false, 0, false, false);
+					}
+					else if (num == 30)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1965, 1, false, 0, false, false);
+					}
+					else if (num == 31)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2742, 1, false, 0, false, false);
+					}
+					else if (num == 32)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3044, 1, false, 0, false, false);
+					}
+					else if (num == 33)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3235, 1, false, 0, false, false);
+					}
+					else if (num == 34)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3236, 1, false, 0, false, false);
+					}
+					else if (num == 35)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3237, 1, false, 0, false, false);
+					}
+					else if (num == 36)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3370, 1, false, 0, false, false);
+					}
+					else if (num == 37)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3371, 1, false, 0, false, false);
+					}
+					else if (num == 38)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3796, 1, false, 0, false, false);
+					}
+					else if (num == 39)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3869, 1, false, 0, false, false);
+					}
+					else if (num >= 13)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1596 + num - 13, 1, false, 0, false, false);
+					}
+					else
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 562 + num, 1, false, 0, false, false);
+					}
 				}
 				for (int num7 = num4 - 1; num7 < num4 + 3; num7++)
 				{
@@ -28351,10 +_,6 @@
 
 		public static bool PlaceObject(int x, int y, int type, bool mute = false, int style = 0, int alternate = 0, int random = -1, int direction = -1)
 		{
-			if (type >= 467)
-			{
-				return false;
-			}
 			TileObject toBePlaced;
 			if (!TileObject.CanPlace(x, y, type, style, direction, out toBePlaced, false))
 			{
@@ -28550,7 +_,8 @@
 			{
 				type2 = 3239;
 			}
-			Item.NewItem(x * 16, y * 16, num * 16, num2 * 16, type2, 1, false, 0, false, false);
+			if (TileLoader.Drop(x, y, type, TileStyle.Style2x2))
+				Item.NewItem(x * 16, y * 16, num * 16, num2 * 16, type2, 1, false, 0, false, false);
 			for (int k = x - 1; k < x + num + 1; k++)
 			{
 				for (int l = y - 1; l < y + num2 + 1; l++)
@@ -28611,7 +_,8 @@
 			{
 				type2 = 3240;
 			}
-			Item.NewItem(x * 16, y * 16, width * 16, height * 16, type2, 1, false, 0, false, false);
+			if (TileLoader.Drop(x, y, type, TileStyle.Style1x5))
+				Item.NewItem(x * 16, y * 16, width * 16, height * 16, type2, 1, false, 0, false, false);
 			for (int l = x - 1; l < x + width + 1; l++)
 			{
 				for (int m = y - 1; m < y + height + 1; m++)
@@ -29022,7 +_,7 @@
 					flag2 = false;
 				}
 			}
-			if (type == 88)
+			if (TileLoader.IsDresser(type))
 			{
 				int num2 = Chest.CreateChest(x - 1, y - 1, -1);
 				if (num2 == -1)
@@ -29239,175 +_,178 @@
 						}
 					}
 				}
-				if (type == 254)
-				{
-					if (frameX >= 72)
-					{
-						if (frameX < 108)
-						{
-							if (WorldGen.genRand.Next(2) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(1, 3), false, 0, false, false);
-							}
-						}
-						else if (frameX < 144)
-						{
-							Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(2, 6), false, 0, false, false);
-						}
-						else
-						{
-							Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(5, 11), false, 0, false, false);
-							if (Main.halloween && WorldGen.genRand.Next(200) == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 32, 32, 1799, 1, false, 0, false, false);
-							}
-						}
-					}
-				}
-				else if (type == 457)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3749, 1, false, 0, false, false);
-				}
-				else if (type == 96)
-				{
-					if (num2 == 0)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 345, 1, false, 0, false, false);
-					}
-					if (num2 == 1)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, 1791, 1, false, 0, false, false);
-					}
-				}
-				else if (type == 441)
-				{
-					int num6 = -1;
-					switch (num2)
-					{
-						case 0:
-							num6 = 3665;
-							break;
-						case 1:
-							num6 = 3666;
-							break;
-						case 3:
-							num6 = 3667;
-							break;
-						case 7:
-							num6 = 3668;
-							break;
-						case 8:
-							num6 = 3669;
-							break;
-						case 9:
-							num6 = 3670;
-							break;
-						case 10:
-							num6 = 3671;
-							break;
-						case 11:
-							num6 = 3672;
-							break;
-						case 12:
-							num6 = 3673;
-							break;
-						case 13:
-							num6 = 3674;
-							break;
-						case 14:
-							num6 = 3675;
-							break;
-						case 15:
-							num6 = 3676;
-							break;
-						case 16:
-							num6 = 3677;
-							break;
-						case 17:
-							num6 = 3678;
-							break;
-						case 18:
-							num6 = 3679;
-							break;
-						case 19:
-							num6 = 3680;
-							break;
-						case 20:
-							num6 = 3681;
-							break;
-						case 21:
-							num6 = 3682;
-							break;
-						case 22:
-							num6 = 3683;
-							break;
-						case 28:
-							num6 = 3684;
-							break;
-						case 29:
-							num6 = 3685;
-							break;
-						case 30:
-							num6 = 3686;
-							break;
-						case 31:
-							num6 = 3687;
-							break;
-						case 32:
-							num6 = 3688;
-							break;
-						case 33:
-							num6 = 3689;
-							break;
-						case 34:
-							num6 = 3690;
-							break;
-						case 35:
-							num6 = 3691;
-							break;
-						case 37:
-							num6 = 3692;
-							break;
-						case 39:
-							num6 = 3693;
-							break;
-						case 41:
-							num6 = 3694;
-							break;
-						case 42:
-							num6 = 3695;
-							break;
-						case 43:
-							num6 = 3696;
-							break;
-						case 44:
-							num6 = 3697;
-							break;
-						case 45:
-							num6 = 3698;
-							break;
-						case 46:
-							num6 = 3699;
-							break;
-						case 47:
-							num6 = 3700;
-							break;
-						case 48:
-							num6 = 3701;
-							break;
-						case 49:
-							num6 = 3703;
-							break;
-						case 50:
-							num6 = 3702;
-							break;
-						case 51:
-							num6 = 3704;
-							break;
-					}
-					if (num6 != -1)
-					{
-						Item.NewItem(i * 16, j * 16, 32, 32, num6, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style2x2))
+				{
+					if (type == 254)
+					{
+						if (frameX >= 72)
+						{
+							if (frameX < 108)
+							{
+								if (WorldGen.genRand.Next(2) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(1, 3), false, 0, false, false);
+								}
+							}
+							else if (frameX < 144)
+							{
+								Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(2, 6), false, 0, false, false);
+							}
+							else
+							{
+								Item.NewItem(i * 16, j * 16, 32, 32, 1725, WorldGen.genRand.Next(5, 11), false, 0, false, false);
+								if (Main.halloween && WorldGen.genRand.Next(200) == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 32, 32, 1799, 1, false, 0, false, false);
+								}
+							}
+						}
+					}
+					else if (type == 457)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3749, 1, false, 0, false, false);
+					}
+					else if (type == 96)
+					{
+						if (num2 == 0)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 345, 1, false, 0, false, false);
+						}
+						if (num2 == 1)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, 1791, 1, false, 0, false, false);
+						}
+					}
+					else if (type == 441)
+					{
+						int num6 = -1;
+						switch (num2)
+						{
+							case 0:
+								num6 = 3665;
+								break;
+							case 1:
+								num6 = 3666;
+								break;
+							case 3:
+								num6 = 3667;
+								break;
+							case 7:
+								num6 = 3668;
+								break;
+							case 8:
+								num6 = 3669;
+								break;
+							case 9:
+								num6 = 3670;
+								break;
+							case 10:
+								num6 = 3671;
+								break;
+							case 11:
+								num6 = 3672;
+								break;
+							case 12:
+								num6 = 3673;
+								break;
+							case 13:
+								num6 = 3674;
+								break;
+							case 14:
+								num6 = 3675;
+								break;
+							case 15:
+								num6 = 3676;
+								break;
+							case 16:
+								num6 = 3677;
+								break;
+							case 17:
+								num6 = 3678;
+								break;
+							case 18:
+								num6 = 3679;
+								break;
+							case 19:
+								num6 = 3680;
+								break;
+							case 20:
+								num6 = 3681;
+								break;
+							case 21:
+								num6 = 3682;
+								break;
+							case 22:
+								num6 = 3683;
+								break;
+							case 28:
+								num6 = 3684;
+								break;
+							case 29:
+								num6 = 3685;
+								break;
+							case 30:
+								num6 = 3686;
+								break;
+							case 31:
+								num6 = 3687;
+								break;
+							case 32:
+								num6 = 3688;
+								break;
+							case 33:
+								num6 = 3689;
+								break;
+							case 34:
+								num6 = 3690;
+								break;
+							case 35:
+								num6 = 3691;
+								break;
+							case 37:
+								num6 = 3692;
+								break;
+							case 39:
+								num6 = 3693;
+								break;
+							case 41:
+								num6 = 3694;
+								break;
+							case 42:
+								num6 = 3695;
+								break;
+							case 43:
+								num6 = 3696;
+								break;
+							case 44:
+								num6 = 3697;
+								break;
+							case 45:
+								num6 = 3698;
+								break;
+							case 46:
+								num6 = 3699;
+								break;
+							case 47:
+								num6 = 3700;
+								break;
+							case 48:
+								num6 = 3701;
+								break;
+							case 49:
+								num6 = 3703;
+								break;
+							case 50:
+								num6 = 3702;
+								break;
+							case 51:
+								num6 = 3704;
+								break;
+						}
+						if (num6 != -1)
+						{
+							Item.NewItem(i * 16, j * 16, 32, 32, num6, 1, false, 0, false, false);
+						}
 					}
 				}
 				WorldGen.destroyObject = false;
@@ -29845,198 +_,201 @@
 						}
 					}
 				}
-				if (type == 454)
-				{
-					switch (Main.rand.Next(9))
-					{
-						case 2:
-						case 3:
-						case 4:
-							{
-								int num9 = Main.rand.Next(10, 31);
-								while (num9 > 0)
-								{
-									int num10 = Main.rand.Next(2, 11);
-									if (num10 > num9)
-									{
-										num10 = num9;
-									}
-									num9 -= num10;
-									Item.NewItem(i * 16, j * 16, 32, 32, 72, num10, false, 0, false, false);
-								}
-								break;
-							}
-						case 5:
-						case 6:
-							{
-								int num11 = Main.rand.Next(60, 80);
-								while (num11 > 0)
-								{
-									int num12 = Main.rand.Next(3, 16);
-									if (num12 > num11)
-									{
-										num12 = num11;
-									}
-									num11 -= num12;
-									Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num12, false, 0, false, false);
-								}
-								Item.NewItem(i * 16, j * 16, 32, 32, 1358, 1, false, 0, false, false);
-								break;
-							}
-						case 7:
-							{
-								int num13 = Main.rand.Next(10, 31);
-								while (num13 > 0)
-								{
-									int num14 = Main.rand.Next(2, 9);
-									if (num14 > num13)
-									{
-										num14 = num13;
-									}
-									num13 -= num14;
-									Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num14, false, 0, false, false);
-								}
-								if (Main.rand.Next(8) == 0)
-								{
-									Item.NewItem(i * 16, j * 16, 32, 32, 3532, 1, false, 0, false, false);
-								}
-								if (Main.rand.Next(8) == 0)
-								{
-									Item.NewItem(i * 16, j * 16, 32, 32, 3532, 1, false, 0, false, false);
-								}
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, 1, false, 0, false, false);
-								break;
-							}
-						case 8:
-							{
-								int num15 = 100;
-								while (num15 > 0)
-								{
-									int num16 = Main.rand.Next(3, 16);
-									if (num16 > num15)
-									{
-										num16 = num15;
-									}
-									num15 -= num16;
-									Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num16, false, 0, false, false);
-								}
-								int num17 = Main.rand.Next(30, 91);
-								while (num17 > 0)
-								{
-									int num18 = Main.rand.Next(7, 14);
-									if (num18 > num17)
-									{
-										num18 = num17;
-									}
-									num17 -= num18;
-									Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 1349, num18, false, 0, false, false);
-								}
-								Item.NewItem(i * 16, j * 16, 32, 32, 1358, 1, false, 0, false, false);
-								Item.NewItem(i * 16, j * 16, 32, 32, 73, 1, false, 0, false, false);
-								break;
-							}
-					}
-				}
-				if (type == 34)
-				{
-					int type2;
-					if (num5 == 1)
-					{
-						type2 = 107;
-					}
-					else if (num5 == 2)
-					{
-						type2 = 108;
-					}
-					else if (num5 == 3)
-					{
-						type2 = 710;
-					}
-					else if (num5 == 4)
-					{
-						type2 = 711;
-					}
-					else if (num5 == 5)
-					{
-						type2 = 712;
-					}
-					else if (num5 == 6)
-					{
-						type2 = 1812;
-					}
-					else if (num5 >= 7 && num5 <= 17)
-					{
-						type2 = 2055 + num5 - 7;
-					}
-					else if (num5 >= 18 && num5 <= 21)
-					{
-						type2 = 2141 + num5 - 18;
-					}
-					else if (num5 == 22)
-					{
-						type2 = 2224;
-					}
-					else if (num5 == 23)
-					{
-						type2 = 2525;
-					}
-					else if (num5 == 24)
-					{
-						type2 = 2543;
-					}
-					else if (num5 == 25)
-					{
-						type2 = 2558;
-					}
-					else if (num5 == 26)
-					{
-						type2 = 2573;
-					}
-					else if (num5 == 27)
-					{
-						type2 = 2652;
-					}
-					else if (num5 == 28)
-					{
-						type2 = 2653;
-					}
-					else if (num5 == 29)
-					{
-						type2 = 2654;
-					}
-					else if (num5 == 30)
-					{
-						type2 = 2655;
-					}
-					else if (num5 == 31)
-					{
-						type2 = 2656;
-					}
-					else if (num5 == 32)
-					{
-						type2 = 2657;
-					}
-					else if (num5 == 33)
-					{
-						type2 = 2813;
-					}
-					else if (num5 == 34)
-					{
-						type2 = 3177;
-					}
-					else if (num5 == 35)
-					{
-						type2 = 3179;
-					}
-					else if (num5 == 36)
-					{
-						type2 = 3178;
-					}
-					else
-					{
-						type2 = 106;
-					}
-					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style3x3))
+				{
+					if (type == 454)
+					{
+						switch (Main.rand.Next(9))
+						{
+							case 2:
+							case 3:
+							case 4:
+								{
+									int num9 = Main.rand.Next(10, 31);
+									while (num9 > 0)
+									{
+										int num10 = Main.rand.Next(2, 11);
+										if (num10 > num9)
+										{
+											num10 = num9;
+										}
+										num9 -= num10;
+										Item.NewItem(i * 16, j * 16, 32, 32, 72, num10, false, 0, false, false);
+									}
+									break;
+								}
+							case 5:
+							case 6:
+								{
+									int num11 = Main.rand.Next(60, 80);
+									while (num11 > 0)
+									{
+										int num12 = Main.rand.Next(3, 16);
+										if (num12 > num11)
+										{
+											num12 = num11;
+										}
+										num11 -= num12;
+										Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num12, false, 0, false, false);
+									}
+									Item.NewItem(i * 16, j * 16, 32, 32, 1358, 1, false, 0, false, false);
+									break;
+								}
+							case 7:
+								{
+									int num13 = Main.rand.Next(10, 31);
+									while (num13 > 0)
+									{
+										int num14 = Main.rand.Next(2, 9);
+										if (num14 > num13)
+										{
+											num14 = num13;
+										}
+										num13 -= num14;
+										Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num14, false, 0, false, false);
+									}
+									if (Main.rand.Next(8) == 0)
+									{
+										Item.NewItem(i * 16, j * 16, 32, 32, 3532, 1, false, 0, false, false);
+									}
+									if (Main.rand.Next(8) == 0)
+									{
+										Item.NewItem(i * 16, j * 16, 32, 32, 3532, 1, false, 0, false, false);
+									}
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, 1, false, 0, false, false);
+									break;
+								}
+							case 8:
+								{
+									int num15 = 100;
+									while (num15 > 0)
+									{
+										int num16 = Main.rand.Next(3, 16);
+										if (num16 > num15)
+										{
+											num16 = num15;
+										}
+										num15 -= num16;
+										Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 72, num16, false, 0, false, false);
+									}
+									int num17 = Main.rand.Next(30, 91);
+									while (num17 > 0)
+									{
+										int num18 = Main.rand.Next(7, 14);
+										if (num18 > num17)
+										{
+											num18 = num17;
+										}
+										num17 -= num18;
+										Item.NewItem(i * 16 - 10, j * 16 - 10, 52, 52, 1349, num18, false, 0, false, false);
+									}
+									Item.NewItem(i * 16, j * 16, 32, 32, 1358, 1, false, 0, false, false);
+									Item.NewItem(i * 16, j * 16, 32, 32, 73, 1, false, 0, false, false);
+									break;
+								}
+						}
+					}
+					if (type == 34)
+					{
+						int type2;
+						if (num5 == 1)
+						{
+							type2 = 107;
+						}
+						else if (num5 == 2)
+						{
+							type2 = 108;
+						}
+						else if (num5 == 3)
+						{
+							type2 = 710;
+						}
+						else if (num5 == 4)
+						{
+							type2 = 711;
+						}
+						else if (num5 == 5)
+						{
+							type2 = 712;
+						}
+						else if (num5 == 6)
+						{
+							type2 = 1812;
+						}
+						else if (num5 >= 7 && num5 <= 17)
+						{
+							type2 = 2055 + num5 - 7;
+						}
+						else if (num5 >= 18 && num5 <= 21)
+						{
+							type2 = 2141 + num5 - 18;
+						}
+						else if (num5 == 22)
+						{
+							type2 = 2224;
+						}
+						else if (num5 == 23)
+						{
+							type2 = 2525;
+						}
+						else if (num5 == 24)
+						{
+							type2 = 2543;
+						}
+						else if (num5 == 25)
+						{
+							type2 = 2558;
+						}
+						else if (num5 == 26)
+						{
+							type2 = 2573;
+						}
+						else if (num5 == 27)
+						{
+							type2 = 2652;
+						}
+						else if (num5 == 28)
+						{
+							type2 = 2653;
+						}
+						else if (num5 == 29)
+						{
+							type2 = 2654;
+						}
+						else if (num5 == 30)
+						{
+							type2 = 2655;
+						}
+						else if (num5 == 31)
+						{
+							type2 = 2656;
+						}
+						else if (num5 == 32)
+						{
+							type2 = 2657;
+						}
+						else if (num5 == 33)
+						{
+							type2 = 2813;
+						}
+						else if (num5 == 34)
+						{
+							type2 = 3177;
+						}
+						else if (num5 == 35)
+						{
+							type2 = 3179;
+						}
+						else if (num5 == 36)
+						{
+							type2 = 3178;
+						}
+						else
+						{
+							type2 = 106;
+						}
+						Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num19 = k - 1; num19 < k + num + 1; num19++)
@@ -30126,98 +_,101 @@
 						}
 					}
 				}
-				if (type == 106)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 363, 1, false, 0, false, false);
-				}
-				else if (type == 243)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1430, 1, false, 0, false, false);
-				}
-				else if (type == 212)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 951, 1, false, 0, false, false);
-				}
-				else if (type == 219)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 997, 1, false, 0, false, false);
-				}
-				else if (type == 220)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 998, 1, false, 0, false, false);
-				}
-				else if (type == 228)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1120, 1, false, 0, false, false);
-				}
-				else if (type == 247)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 1551, 1, false, 0, false, false);
-				}
-				else if (type == 283)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2172, 1, false, 0, false, false);
-				}
-				else if (type >= 300 && type <= 306)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2192 + type - 300, 1, false, 0, false, false);
-				}
-				else if (type == 307)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2203, 1, false, 0, false, false);
-				}
-				else if (type == 308)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2204, 1, false, 0, false, false);
-				}
-				else if (type == 406)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3365, 1, false, 0, false, false);
-				}
-				else if (type == 452)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3742, 1, false, 0, false, false);
-				}
-				else if (type == 354)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 2999, 1, false, 0, false, false);
-				}
-				else if (type == 355)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3000, 1, false, 0, false, false);
-				}
-				else if (type == 412)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3549, 1, false, 0, false, false);
-				}
-				else if (type == 455)
-				{
-					Item.NewItem(i * 16, j * 16, 32, 32, 3747, 1, false, 0, false, false);
-				}
-				else if (type == 231)
-				{
-					int num9 = (i + 1) * 16 + 8;
-					int num10 = j * 16;
-					Gore.NewGore(new Vector2((float)num9, (float)num10), default(Vector2), 300, 1f);
-					Gore.NewGore(new Vector2((float)num9, (float)(num10 + 8)), default(Vector2), 301, 1f);
-					Gore.NewGore(new Vector2((float)num9, (float)(num10 + 16)), default(Vector2), 302, 1f);
-					float num11 = (float)(i * 16);
-					float num12 = (float)(j * 16);
-					float num13 = -1f;
-					int plr = 0;
-					for (int num14 = 0; num14 < 255; num14++)
-					{
-						if (Main.player[num14].active && !Main.player[num14].dead)
-						{
-							float num15 = Math.Abs(Main.player[num14].position.X - num11) + Math.Abs(Main.player[num14].position.Y - num12);
-							if (num15 < num13 || num13 == -1f)
-							{
-								plr = num14;
-								num13 = num15;
-							}
-						}
-					}
-					NPC.SpawnOnPlayer(plr, 222);
+				if (TileLoader.Drop(num, j, type, TileStyle.Style3x3))
+				{
+					if (type == 106)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 363, 1, false, 0, false, false);
+					}
+					else if (type == 243)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1430, 1, false, 0, false, false);
+					}
+					else if (type == 212)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 951, 1, false, 0, false, false);
+					}
+					else if (type == 219)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 997, 1, false, 0, false, false);
+					}
+					else if (type == 220)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 998, 1, false, 0, false, false);
+					}
+					else if (type == 228)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1120, 1, false, 0, false, false);
+					}
+					else if (type == 247)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 1551, 1, false, 0, false, false);
+					}
+					else if (type == 283)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2172, 1, false, 0, false, false);
+					}
+					else if (type >= 300 && type <= 306)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2192 + type - 300, 1, false, 0, false, false);
+					}
+					else if (type == 307)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2203, 1, false, 0, false, false);
+					}
+					else if (type == 308)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2204, 1, false, 0, false, false);
+					}
+					else if (type == 406)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3365, 1, false, 0, false, false);
+					}
+					else if (type == 452)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3742, 1, false, 0, false, false);
+					}
+					else if (type == 354)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 2999, 1, false, 0, false, false);
+					}
+					else if (type == 355)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3000, 1, false, 0, false, false);
+					}
+					else if (type == 412)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3549, 1, false, 0, false, false);
+					}
+					else if (type == 455)
+					{
+						Item.NewItem(i * 16, j * 16, 32, 32, 3747, 1, false, 0, false, false);
+					}
+					else if (type == 231)
+					{
+						int num9 = (i + 1) * 16 + 8;
+						int num10 = j * 16;
+						Gore.NewGore(new Vector2((float)num9, (float)num10), default(Vector2), 300, 1f);
+						Gore.NewGore(new Vector2((float)num9, (float)(num10 + 8)), default(Vector2), 301, 1f);
+						Gore.NewGore(new Vector2((float)num9, (float)(num10 + 16)), default(Vector2), 302, 1f);
+						float num11 = (float)(i * 16);
+						float num12 = (float)(j * 16);
+						float num13 = -1f;
+						int plr = 0;
+						for (int num14 = 0; num14 < 255; num14++)
+						{
+							if (Main.player[num14].active && !Main.player[num14].dead)
+							{
+								float num15 = Math.Abs(Main.player[num14].position.X - num11) + Math.Abs(Main.player[num14].position.Y - num12);
+								if (num15 < num13 || num13 == -1f)
+								{
+									plr = num14;
+									num13 = num15;
+								}
+							}
+						}
+						NPC.SpawnOnPlayer(plr, 222);
+					}
 				}
 				WorldGen.destroyObject = false;
 				for (int num16 = k - 1; num16 < k + 4; num16++)
@@ -30484,7 +_,8 @@
 						}
 					}
 				}
-				Item.NewItem(i * 16, j * 16, 32, 32, 63, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style2x4))
+					Item.NewItem(i * 16, j * 16, 32, 32, 63, 1, false, 0, false, false);
 				WorldGen.destroyObject = false;
 			}
 		}
@@ -30650,7 +_,7 @@
 					}
 				}
 			}
-			if (!Main.tile[num2, num].nactive() || Main.tile[num2, num].halfBrick() || Main.tile[num2, num].slope() != 0 || (Main.tile[num2, num].type != 53 && Main.tile[num2, num].type != 112 && Main.tile[num2, num].type != 116 && Main.tile[num2, num].type != 234))
+			if (!Main.tile[num2, num].nactive() || Main.tile[num2, num].halfBrick() || Main.tile[num2, num].slope() != 0 || (Main.tile[num2, num].type != 53 && Main.tile[num2, num].type != 112 && Main.tile[num2, num].type != 116 && Main.tile[num2, num].type != 234 && !TileLoader.CanGrowModCactus(Main.tile[num2, num2].type)))
 			{
 				WorldGen.KillTile(i, j, false, false, false);
 				return true;
@@ -30663,7 +_,7 @@
 					return true;
 				}
 			}
-			else if (i == num2 && (!Main.tile[i, j + 1].active() || (Main.tile[i, j + 1].type != 80 && Main.tile[i, j + 1].type != 53 && Main.tile[i, j + 1].type != 112 && Main.tile[i, j + 1].type != 116 && Main.tile[i, j + 1].type != 234)))
+			else if (i == num2 && (!Main.tile[i, j + 1].active() || (Main.tile[i, j + 1].type != 80 && Main.tile[i, j + 1].type != 53 && Main.tile[i, j + 1].type != 112 && Main.tile[i, j + 1].type != 116 && Main.tile[i, j + 1].type != 234 && !TileLoader.CanGrowModCactus(Main.tile[i, j + 1].type))))
 			{
 				WorldGen.KillTile(i, j, false, false, false);
 				return true;
@@ -30751,129 +_,132 @@
 				}
 				if (Main.netMode != 1 && !WorldGen.noTileActions)
 				{
-					if (type == 12)
-					{
-						Item.NewItem(num * 16, num2 * 16, 32, 32, 29, 1, false, 0, false, false);
-					}
-					else if (type == 31)
-					{
-						if (WorldGen.genRand.Next(2) == 0)
-						{
-							WorldGen.spawnMeteor = true;
+					if (TileLoader.Drop(num, num2, type, TileStyle.Style2x2))
+					{
+						if (type == 12)
+						{
+							Item.NewItem(num * 16, num2 * 16, 32, 32, 29, 1, false, 0, false, false);
+						}
+						else if (type == 31)
+						{
+							if (WorldGen.genRand.Next(2) == 0)
+							{
+								WorldGen.spawnMeteor = true;
+							}
+							if (flag)
+							{
+								int num3 = Main.rand.Next(5);
+								if (!WorldGen.shadowOrbSmashed)
+								{
+									num3 = 0;
+								}
+								if (num3 == 0)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 800, 1, false, -1, false, false);
+									int stack = WorldGen.genRand.Next(100, 101);
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 97, stack, false, 0, false, false);
+								}
+								else if (num3 == 1)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 1256, 1, false, -1, false, false);
+								}
+								else if (num3 == 2)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 802, 1, false, -1, false, false);
+								}
+								else if (num3 == 3)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 3062, 1, false, -1, false, false);
+								}
+								else if (num3 == 4)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 1290, 1, false, -1, false, false);
+								}
+							}
+							else
+							{
+								int num4 = Main.rand.Next(5);
+								if (!WorldGen.shadowOrbSmashed)
+								{
+									num4 = 0;
+								}
+								if (num4 == 0)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 96, 1, false, -1, false, false);
+									int stack2 = WorldGen.genRand.Next(100, 101);
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 97, stack2, false, 0, false, false);
+								}
+								else if (num4 == 1)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 64, 1, false, -1, false, false);
+								}
+								else if (num4 == 2)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 162, 1, false, -1, false, false);
+								}
+								else if (num4 == 3)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 115, 1, false, -1, false, false);
+								}
+								else if (num4 == 4)
+								{
+									Item.NewItem(num * 16, num2 * 16, 32, 32, 111, 1, false, -1, false, false);
+								}
+							}
+							WorldGen.shadowOrbSmashed = true;
+							WorldGen.shadowOrbCount++;
+							if (WorldGen.shadowOrbCount >= 3)
+							{
+								WorldGen.shadowOrbCount = 0;
+								float num5 = (float)(num * 16);
+								float num6 = (float)(num2 * 16);
+								float num7 = -1f;
+								int plr = 0;
+								for (int num8 = 0; num8 < 255; num8++)
+								{
+									float num9 = Math.Abs(Main.player[num8].position.X - num5) + Math.Abs(Main.player[num8].position.Y - num6);
+									if (num9 < num7 || num7 == -1f)
+									{
+										plr = num8;
+										num7 = num9;
+									}
+								}
+								if (flag)
+								{
+									NPC.SpawnOnPlayer(plr, 266);
+								}
+								else
+								{
+									NPC.SpawnOnPlayer(plr, 13);
+								}
+							}
+							else
+							{
+								string text = Lang.misc[10];
+								if (WorldGen.shadowOrbCount == 2)
+								{
+									text = Lang.misc[11];
+								}
+								if (Main.netMode == 0)
+								{
+									Main.NewText(text, 50, 255, 130, false);
+								}
+								else if (Main.netMode == 2)
+								{
+									NetMessage.SendData(25, -1, -1, text, 255, 50f, 255f, 130f, 0, 0, 0);
+								}
+							}
+							AchievementsHelper.NotifyProgressionEvent(7);
 						}
 						if (flag)
 						{
-							int num3 = Main.rand.Next(5);
-							if (!WorldGen.shadowOrbSmashed)
-							{
-								num3 = 0;
-							}
-							if (num3 == 0)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 800, 1, false, -1, false, false);
-								int stack = WorldGen.genRand.Next(100, 101);
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 97, stack, false, 0, false, false);
-							}
-							else if (num3 == 1)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 1256, 1, false, -1, false, false);
-							}
-							else if (num3 == 2)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 802, 1, false, -1, false, false);
-							}
-							else if (num3 == 3)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 3062, 1, false, -1, false, false);
-							}
-							else if (num3 == 4)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 1290, 1, false, -1, false, false);
-							}
+							Main.PlaySound(4, i * 16, j * 16, 1, 1f, 0f);
 						}
 						else
 						{
-							int num4 = Main.rand.Next(5);
-							if (!WorldGen.shadowOrbSmashed)
-							{
-								num4 = 0;
-							}
-							if (num4 == 0)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 96, 1, false, -1, false, false);
-								int stack2 = WorldGen.genRand.Next(100, 101);
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 97, stack2, false, 0, false, false);
-							}
-							else if (num4 == 1)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 64, 1, false, -1, false, false);
-							}
-							else if (num4 == 2)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 162, 1, false, -1, false, false);
-							}
-							else if (num4 == 3)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 115, 1, false, -1, false, false);
-							}
-							else if (num4 == 4)
-							{
-								Item.NewItem(num * 16, num2 * 16, 32, 32, 111, 1, false, -1, false, false);
-							}
-						}
-						WorldGen.shadowOrbSmashed = true;
-						WorldGen.shadowOrbCount++;
-						if (WorldGen.shadowOrbCount >= 3)
-						{
-							WorldGen.shadowOrbCount = 0;
-							float num5 = (float)(num * 16);
-							float num6 = (float)(num2 * 16);
-							float num7 = -1f;
-							int plr = 0;
-							for (int num8 = 0; num8 < 255; num8++)
-							{
-								float num9 = Math.Abs(Main.player[num8].position.X - num5) + Math.Abs(Main.player[num8].position.Y - num6);
-								if (num9 < num7 || num7 == -1f)
-								{
-									plr = num8;
-									num7 = num9;
-								}
-							}
-							if (flag)
-							{
-								NPC.SpawnOnPlayer(plr, 266);
-							}
-							else
-							{
-								NPC.SpawnOnPlayer(plr, 13);
-							}
-						}
-						else
-						{
-							string text = Lang.misc[10];
-							if (WorldGen.shadowOrbCount == 2)
-							{
-								text = Lang.misc[11];
-							}
-							if (Main.netMode == 0)
-							{
-								Main.NewText(text, 50, 255, 130, false);
-							}
-							else if (Main.netMode == 2)
-							{
-								NetMessage.SendData(25, -1, -1, text, 255, 50f, 255f, 130f, 0, 0, 0);
-							}
-						}
-						AchievementsHelper.NotifyProgressionEvent(7);
-					}
-				}
-				if (flag)
-				{
-					Main.PlaySound(4, i * 16, j * 16, 1, 1f, 0f);
-				}
-				else
-				{
-					Main.PlaySound(13, i * 16, j * 16, 1, 1f, 0f);
+							Main.PlaySound(13, i * 16, j * 16, 1, 1f, 0f);
+						}
+					}
 				}
 				WorldGen.destroyObject = false;
 			}
@@ -30907,6 +_,10 @@
 				num2 = 53;
 			}
 			if (num2 == 112)
+			{
+				num2 = 53;
+			}
+			if (TileLoader.CanGrowModPalmTree(num2))
 			{
 				num2 = 53;
 			}
@@ -31000,6 +_,10 @@
 			{
 				num4 = 2;
 			}
+			if (TileLoader.CanGrowModTree(num4))
+			{
+				num4 = 2;
+			}
 			if (num4 != 2 && num4 != type && ((Main.tile[i, j].frameX == 0 && Main.tile[i, j].frameY <= 130) || (Main.tile[i, j].frameX == 22 && Main.tile[i, j].frameY <= 130) || (Main.tile[i, j].frameX == 44 && Main.tile[i, j].frameY <= 130)))
 			{
 				WorldGen.KillTile(i, j, false, false, false);
@@ -31343,7 +_,7 @@
 						int wall = (int)Main.tile[k, l].wall;
 						if (conversionType == 4)
 						{
-							if (type <= 467 && wall <= 231)
+							if (true)
 							{
 								if (WallID.Sets.Conversion.Grass[wall] && wall != 81)
 								{
@@ -31421,7 +_,7 @@
 						}
 						else if (conversionType == 2)
 						{
-							if (type <= 467 && wall <= 231)
+							if (true)
 							{
 								if (WallID.Sets.Conversion.Grass[wall] && wall != 70)
 								{
@@ -31501,7 +_,7 @@
 						}
 						else if (conversionType == 1)
 						{
-							if (type <= 467 && wall <= 231)
+							if (true)
 							{
 								if (WallID.Sets.Conversion.Grass[wall] && wall != 69)
 								{
@@ -31944,11 +_,11 @@
 			{
 				return;
 			}
-			if (Main.tile[i, j].type != 53 && Main.tile[i, j].type != 80 && Main.tile[i, j].type != 234 && Main.tile[i, j].type != 112 && Main.tile[i, j].type != 116)
+			if (Main.tile[i, j].type != 53 && Main.tile[i, j].type != 80 && Main.tile[i, j].type != 234 && Main.tile[i, j].type != 112 && Main.tile[i, j].type != 116 && !TileLoader.CanGrowModCactus(Main.tile[i, j].type))
 			{
 				return;
 			}
-			if (Main.tile[i, j].type == 53 || Main.tile[i, j].type == 112 || Main.tile[i, j].type == 116 || Main.tile[i, j].type == 234)
+			if (Main.tile[i, j].type == 53 || Main.tile[i, j].type == 112 || Main.tile[i, j].type == 116 || Main.tile[i, j].type == 234 || TileLoader.CanGrowModCactus(Main.tile[i, j].type))
 			{
 				if (Main.tile[i, j - 1].active() || Main.tile[i - 1, j - 1].active() || Main.tile[i + 1, j - 1].active())
 				{
@@ -31972,7 +_,7 @@
 										return;
 									}
 								}
-								if (Main.tile[k, l].type == 53 || Main.tile[k, l].type == 112 || Main.tile[k, l].type == 116 || Main.tile[k, l].type == 234)
+								if (Main.tile[k, l].type == 53 || Main.tile[k, l].type == 112 || Main.tile[k, l].type == 116 || Main.tile[k, l].type == 234 || TileLoader.CanGrowModCactus(Main.tile[k, l].type))
 								{
 									num4++;
 								}
@@ -32195,608 +_,618 @@
 			}
 			if (flag)
 			{
-				WorldGen.destroyObject = true;
-				if (num >= 7 && num <= 9)
-				{
-					Main.PlaySound(6, i * 16, j * 16, 1, 1f, 0f);
-				}
-				else if (num >= 16 && num <= 24)
-				{
-					Main.PlaySound(4, i * 16, j * 16, 1, 1f, 0f);
-				}
-				else
-				{
-					Main.PlaySound(13, i * 16, j * 16, 1, 1f, 0f);
-				}
-				for (int num4 = k; num4 < k + 2; num4++)
-				{
-					for (int num5 = num2; num5 < num2 + 2; num5++)
-					{
-						if ((int)Main.tile[num4, num5].type == type && Main.tile[num4, num5].active())
-						{
-							WorldGen.KillTile(num4, num5, false, false, false);
-						}
-					}
-				}
-				float num6 = 1f;
-				if (num == 0)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 51, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 52, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 53, 1f);
-				}
-				else if (num == 1)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 166, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 167, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 168, 1f);
-				}
-				else if (num == 2)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 169, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 170, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 171, 1f);
-				}
-				else if (num == 3)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 172, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 173, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 174, 1f);
-				}
-				else if (num >= 4 && num <= 6)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 197, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 198, 1f);
-					num6 = 1.25f;
-				}
-				else if (num >= 7 && num <= 9)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 199, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 200, 1f);
-					num6 = 1.75f;
-				}
-				else if (num >= 10 && num <= 12)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 201, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 202, 1f);
-					num6 = 1.9f;
-				}
-				else if (num >= 13 && num <= 15)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 203, 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 204, 1f);
-					num6 = 2.1f;
-				}
-				else if (num >= 16 && num <= 18)
-				{
-					num6 = 1.6f;
-				}
-				else if (num >= 19 && num <= 21)
-				{
-					num6 = 3.5f;
-				}
-				else if (num >= 22 && num <= 24)
-				{
-					num6 = 1.6f;
-				}
-				else if (num >= 25 && num <= 27)
-				{
-					num6 = 10f;
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(217, 220), 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(217, 220), 1f);
-				}
-				else if (num >= 28 && num <= 30)
-				{
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(315, 317), 1f);
-					Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(315, 317), 1f);
-					if (Main.hardMode)
-					{
-						num6 = 4f;
-					}
-				}
-				else if (num >= 31 && num <= 33)
-				{
-					int num7 = WorldGen.genRand.Next(2, 5);
-					for (int num8 = 0; num8 < num7; num8++)
-					{
-						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 698 + WorldGen.genRand.Next(6), 1f);
-					}
-					num6 = 2f;
-				}
-				num6 = (num6 * 2f + 1f) / 3f;
-				int maxValue = (int)(250f / ((num6 + 1f) / 2f));
-				if (!WorldGen.gen)
-				{
-					if (Main.rand.Next(maxValue) == 0)
-					{
-						if (Main.netMode != 1)
-						{
-							Projectile.NewProjectile((float)(i * 16 + 16), (float)(j * 16 + 16), 0f, -12f, 518, 0, 0f, Main.myPlayer, 0f, 0f);
-						}
-					}
-					else if (WorldGen.genRand.Next(40) == 0 && Main.wallDungeon[(int)Main.tile[i, j].wall] && (double)j > Main.worldSurface)
-					{
-						Item.NewItem(i * 16, j * 16, 16, 16, 327, 1, false, 0, false, false);
-					}
-					else if (WorldGen.genRand.Next(45) == 0 || (Main.rand.Next(45) == 0 && Main.expertMode))
-					{
-						if ((double)j < Main.worldSurface)
-						{
-							int num9 = WorldGen.genRand.Next(10);
-							if (num9 == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 292, 1, false, 0, false, false);
-							}
-							if (num9 == 1)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 298, 1, false, 0, false, false);
-							}
-							if (num9 == 2)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
-							}
-							if (num9 == 3)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 290, 1, false, 0, false, false);
-							}
-							if (num9 == 4)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
-							}
-							if (num9 == 5)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2324, 1, false, 0, false, false);
-							}
-							if (num9 == 6)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2325, 1, false, 0, false, false);
-							}
-							if (num9 >= 7)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
-							}
-						}
-						else if ((double)j < Main.rockLayer)
-						{
-							int num10 = WorldGen.genRand.Next(11);
-							if (num10 == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 289, 1, false, 0, false, false);
-							}
-							if (num10 == 1)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 298, 1, false, 0, false, false);
-							}
-							if (num10 == 2)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
-							}
-							if (num10 == 3)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 290, 1, false, 0, false, false);
-							}
-							if (num10 == 4)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 303, 1, false, 0, false, false);
-							}
-							if (num10 == 5)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 291, 1, false, 0, false, false);
-							}
-							if (num10 == 6)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
-							}
-							if (num10 == 7)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
-							}
-							if (num10 == 8)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2329, 1, false, 0, false, false);
-							}
-							if (num10 >= 9)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
-							}
-						}
-						else if (j < Main.maxTilesY - 200)
-						{
-							int num11 = WorldGen.genRand.Next(15);
-							if (num11 == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 296, 1, false, 0, false, false);
-							}
-							if (num11 == 1)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 295, 1, false, 0, false, false);
-							}
-							if (num11 == 2)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
-							}
-							if (num11 == 3)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
-							}
-							if (num11 == 4)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 303, 1, false, 0, false, false);
-							}
-							if (num11 == 5)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 305, 1, false, 0, false, false);
-							}
-							if (num11 == 6)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 301, 1, false, 0, false, false);
-							}
-							if (num11 == 7)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
-							}
-							if (num11 == 8)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 297, 1, false, 0, false, false);
-							}
-							if (num11 == 9)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
-							}
-							if (num11 == 10)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
-							}
-							if (num11 == 11)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2323, 1, false, 0, false, false);
-							}
-							if (num11 == 12)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2327, 1, false, 0, false, false);
-							}
-							if (num11 == 13)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2329, 1, false, 0, false, false);
-							}
-							if (num11 == 14)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
-							}
+				// size ???
+				if (TileLoader.Drop(num, num2, type, TileStyle.Empty))
+				{
+					WorldGen.destroyObject = true;
+					if (num >= 7 && num <= 9)
+					{
+						Main.PlaySound(6, i * 16, j * 16, 1, 1f, 0f);
+					}
+					else if (num >= 16 && num <= 24)
+					{
+						Main.PlaySound(4, i * 16, j * 16, 1, 1f, 0f);
+					}
+					else
+					{
+						Main.PlaySound(13, i * 16, j * 16, 1, 1f, 0f);
+					}
+					for (int num4 = k; num4 < k + 2; num4++)
+					{
+						for (int num5 = num2; num5 < num2 + 2; num5++)
+						{
+							if ((int)Main.tile[num4, num5].type == type && Main.tile[num4, num5].active())
+							{
+								WorldGen.KillTile(num4, num5, false, false, false);
+							}
+						}
+					}
+					float num6 = 1f;
+					if (num == 0)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 51, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 52, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 53, 1f);
+					}
+					else if (num == 1)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 166, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 167, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 168, 1f);
+					}
+					else if (num == 2)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 169, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 170, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 171, 1f);
+					}
+					else if (num == 3)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 172, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 173, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 174, 1f);
+					}
+					else if (num >= 4 && num <= 6)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 197, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 198, 1f);
+						num6 = 1.25f;
+					}
+					else if (num >= 7 && num <= 9)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 199, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 200, 1f);
+						num6 = 1.75f;
+					}
+					else if (num >= 10 && num <= 12)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 201, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 202, 1f);
+						num6 = 1.9f;
+					}
+					else if (num >= 13 && num <= 15)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 203, 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 204, 1f);
+						num6 = 2.1f;
+					}
+					else if (num >= 16 && num <= 18)
+					{
+						num6 = 1.6f;
+					}
+					else if (num >= 19 && num <= 21)
+					{
+						num6 = 3.5f;
+					}
+					else if (num >= 22 && num <= 24)
+					{
+						num6 = 1.6f;
+					}
+					else if (num >= 25 && num <= 27)
+					{
+						num6 = 10f;
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(217, 220), 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(217, 220), 1f);
+					}
+					else if (num >= 28 && num <= 30)
+					{
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(315, 317), 1f);
+						Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), WorldGen.genRand.Next(315, 317), 1f);
+						if (Main.hardMode)
+						{
+							num6 = 4f;
+						}
+					}
+					else if (num >= 31 && num <= 33)
+					{
+						int num7 = WorldGen.genRand.Next(2, 5);
+						for (int num8 = 0; num8 < num7; num8++)
+						{
+							Gore.NewGore(new Vector2((float)(i * 16), (float)(j * 16)), default(Vector2), 698 + WorldGen.genRand.Next(6), 1f);
+						}
+						num6 = 2f;
+					}
+					num6 = (num6 * 2f + 1f) / 3f;
+					int maxValue = (int)(250f / ((num6 + 1f) / 2f));
+					if (!WorldGen.gen)
+					{
+						if (Main.rand.Next(maxValue) == 0)
+						{
+							if (Main.netMode != 1)
+							{
+								Projectile.NewProjectile((float)(i * 16 + 16), (float)(j * 16 + 16), 0f, -12f, 518, 0, 0f, Main.myPlayer, 0f,
+									0f);
+							}
+						}
+						else if (WorldGen.genRand.Next(40) == 0 && Main.wallDungeon[(int)Main.tile[i, j].wall] &&
+								(double)j > Main.worldSurface)
+						{
+							Item.NewItem(i * 16, j * 16, 16, 16, 327, 1, false, 0, false, false);
+						}
+						else if (WorldGen.genRand.Next(45) == 0 || (Main.rand.Next(45) == 0 && Main.expertMode))
+						{
+							if ((double)j < Main.worldSurface)
+							{
+								int num9 = WorldGen.genRand.Next(10);
+								if (num9 == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 292, 1, false, 0, false, false);
+								}
+								if (num9 == 1)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 298, 1, false, 0, false, false);
+								}
+								if (num9 == 2)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
+								}
+								if (num9 == 3)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 290, 1, false, 0, false, false);
+								}
+								if (num9 == 4)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
+								}
+								if (num9 == 5)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2324, 1, false, 0, false, false);
+								}
+								if (num9 == 6)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2325, 1, false, 0, false, false);
+								}
+								if (num9 >= 7)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
+								}
+							}
+							else if ((double)j < Main.rockLayer)
+							{
+								int num10 = WorldGen.genRand.Next(11);
+								if (num10 == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 289, 1, false, 0, false, false);
+								}
+								if (num10 == 1)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 298, 1, false, 0, false, false);
+								}
+								if (num10 == 2)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
+								}
+								if (num10 == 3)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 290, 1, false, 0, false, false);
+								}
+								if (num10 == 4)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 303, 1, false, 0, false, false);
+								}
+								if (num10 == 5)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 291, 1, false, 0, false, false);
+								}
+								if (num10 == 6)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
+								}
+								if (num10 == 7)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
+								}
+								if (num10 == 8)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2329, 1, false, 0, false, false);
+								}
+								if (num10 >= 9)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
+								}
+							}
+							else if (j < Main.maxTilesY - 200)
+							{
+								int num11 = WorldGen.genRand.Next(15);
+								if (num11 == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 296, 1, false, 0, false, false);
+								}
+								if (num11 == 1)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 295, 1, false, 0, false, false);
+								}
+								if (num11 == 2)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 299, 1, false, 0, false, false);
+								}
+								if (num11 == 3)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
+								}
+								if (num11 == 4)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 303, 1, false, 0, false, false);
+								}
+								if (num11 == 5)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 305, 1, false, 0, false, false);
+								}
+								if (num11 == 6)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 301, 1, false, 0, false, false);
+								}
+								if (num11 == 7)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
+								}
+								if (num11 == 8)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 297, 1, false, 0, false, false);
+								}
+								if (num11 == 9)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
+								}
+								if (num11 == 10)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2322, 1, false, 0, false, false);
+								}
+								if (num11 == 11)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2323, 1, false, 0, false, false);
+								}
+								if (num11 == 12)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2327, 1, false, 0, false, false);
+								}
+								if (num11 == 13)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2329, 1, false, 0, false, false);
+								}
+								if (num11 == 14)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2350, 1, false, 0, false, false);
+								}
+							}
+							else
+							{
+								int num12 = WorldGen.genRand.Next(14);
+								if (num12 == 0)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 296, 1, false, 0, false, false);
+								}
+								if (num12 == 1)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 295, 1, false, 0, false, false);
+								}
+								if (num12 == 2)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 293, 1, false, 0, false, false);
+								}
+								if (num12 == 3)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 288, 1, false, 0, false, false);
+								}
+								if (num12 == 4)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 294, 1, false, 0, false, false);
+								}
+								if (num12 == 5)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 297, 1, false, 0, false, false);
+								}
+								if (num12 == 6)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
+								}
+								if (num12 == 7)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 305, 1, false, 0, false, false);
+								}
+								if (num12 == 8)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 301, 1, false, 0, false, false);
+								}
+								if (num12 == 9)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
+								}
+								if (num12 == 10)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 288, 1, false, 0, false, false);
+								}
+								if (num12 == 11)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 300, 1, false, 0, false, false);
+								}
+								if (num12 == 12)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2323, 1, false, 0, false, false);
+								}
+								if (num12 == 13)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 2326, 1, false, 0, false, false);
+								}
+							}
+						}
+						else if (Main.netMode == 2 && Main.rand.Next(30) == 0)
+						{
+							Item.NewItem(i * 16, j * 16, 16, 16, 2997, 1, false, 0, false, false);
 						}
 						else
 						{
-							int num12 = WorldGen.genRand.Next(14);
-							if (num12 == 0)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 296, 1, false, 0, false, false);
-							}
-							if (num12 == 1)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 295, 1, false, 0, false, false);
-							}
-							if (num12 == 2)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 293, 1, false, 0, false, false);
-							}
-							if (num12 == 3)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 288, 1, false, 0, false, false);
-							}
-							if (num12 == 4)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 294, 1, false, 0, false, false);
-							}
-							if (num12 == 5)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 297, 1, false, 0, false, false);
-							}
-							if (num12 == 6)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 304, 1, false, 0, false, false);
-							}
-							if (num12 == 7)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 305, 1, false, 0, false, false);
-							}
-							if (num12 == 8)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 301, 1, false, 0, false, false);
-							}
-							if (num12 == 9)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 302, 1, false, 0, false, false);
-							}
-							if (num12 == 10)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 288, 1, false, 0, false, false);
-							}
-							if (num12 == 11)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 300, 1, false, 0, false, false);
-							}
-							if (num12 == 12)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2323, 1, false, 0, false, false);
-							}
-							if (num12 == 13)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 2326, 1, false, 0, false, false);
-							}
-						}
-					}
-					else if (Main.netMode == 2 && Main.rand.Next(30) == 0)
-					{
-						Item.NewItem(i * 16, j * 16, 16, 16, 2997, 1, false, 0, false, false);
-					}
-					else
-					{
-						int num13 = Main.rand.Next(8);
-						if (Main.expertMode)
-						{
-							num13--;
-						}
-						if (num13 == 0 && Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statLife < Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statLifeMax2)
-						{
-							Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
-							if (Main.rand.Next(2) == 0)
+							int num13 = Main.rand.Next(8);
+							if (Main.expertMode)
+							{
+								num13--;
+							}
+							if (num13 == 0 &&
+								Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statLife <
+								Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statLifeMax2)
 							{
 								Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
-							}
-							if (Main.expertMode)
-							{
 								if (Main.rand.Next(2) == 0)
 								{
 									Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
 								}
-								if (Main.rand.Next(2) == 0)
-								{
-									Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
-								}
-							}
-						}
-						else if (num13 == 1 && Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statMana < Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statManaMax2)
-						{
-							Item.NewItem(i * 16, j * 16, 16, 16, 184, 1, false, 0, false, false);
-						}
-						else if (num13 == 2)
-						{
-							int num14 = Main.rand.Next(2, 6);
-							if (Main.expertMode)
-							{
-								num14 += Main.rand.Next(1, 7);
-							}
-							if (Main.tile[i, j].liquid > 0)
-							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 282, num14, false, 0, false, false);
+								if (Main.expertMode)
+								{
+									if (Main.rand.Next(2) == 0)
+									{
+										Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
+									}
+									if (Main.rand.Next(2) == 0)
+									{
+										Item.NewItem(i * 16, j * 16, 16, 16, 58, 1, false, 0, false, false);
+									}
+								}
+							}
+							else if (num13 == 1 &&
+									Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statMana <
+									Main.player[(int)Player.FindClosest(new Vector2((float)(i * 16), (float)(j * 16)), 16, 16)].statManaMax2)
+							{
+								Item.NewItem(i * 16, j * 16, 16, 16, 184, 1, false, 0, false, false);
+							}
+							else if (num13 == 2)
+							{
+								int num14 = Main.rand.Next(2, 6);
+								if (Main.expertMode)
+								{
+									num14 += Main.rand.Next(1, 7);
+								}
+								if (Main.tile[i, j].liquid > 0)
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 282, num14, false, 0, false, false);
+								}
+								else
+								{
+									Item.NewItem(i * 16, j * 16, 16, 16, 8, num14, false, 0, false, false);
+								}
+							}
+							else if (num13 == 3)
+							{
+								int stack = Main.rand.Next(10, 21);
+								int type2 = 40;
+								if ((double)j < Main.rockLayer && WorldGen.genRand.Next(2) == 0)
+								{
+									if (Main.hardMode)
+									{
+										type2 = 168;
+									}
+									else
+									{
+										type2 = 42;
+									}
+								}
+								if (j > Main.maxTilesY - 200)
+								{
+									type2 = 265;
+								}
+								else if (Main.hardMode)
+								{
+									if (Main.rand.Next(2) == 0)
+									{
+										type2 = 278;
+									}
+									else
+									{
+										type2 = 47;
+									}
+								}
+								Item.NewItem(i * 16, j * 16, 16, 16, type2, stack, false, 0, false, false);
+							}
+							else if (num13 == 4)
+							{
+								int type3 = 28;
+								if (j > Main.maxTilesY - 200 || Main.hardMode)
+								{
+									type3 = 188;
+								}
+								int num15 = 1;
+								if (Main.expertMode && Main.rand.Next(3) != 0)
+								{
+									num15++;
+								}
+								Item.NewItem(i * 16, j * 16, 16, 16, type3, num15, false, 0, false, false);
+							}
+							else if (num13 == 5 && (double)j > Main.rockLayer)
+							{
+								int num16 = Main.rand.Next(4) + 1;
+								if (Main.expertMode)
+								{
+									num16 += Main.rand.Next(4);
+								}
+								Item.NewItem(i * 16, j * 16, 16, 16, 166, num16, false, 0, false, false);
+							}
+							else if ((num13 == 5 || num13 == 6) && j < Main.maxTilesY - 200 && !Main.hardMode)
+							{
+								int stack2 = Main.rand.Next(20, 41);
+								Item.NewItem(i * 16, j * 16, 16, 16, 965, stack2, false, 0, false, false);
 							}
 							else
 							{
-								Item.NewItem(i * 16, j * 16, 16, 16, 8, num14, false, 0, false, false);
-							}
-						}
-						else if (num13 == 3)
-						{
-							int stack = Main.rand.Next(10, 21);
-							int type2 = 40;
-							if ((double)j < Main.rockLayer && WorldGen.genRand.Next(2) == 0)
-							{
-								if (Main.hardMode)
-								{
-									type2 = 168;
-								}
-								else
-								{
-									type2 = 42;
-								}
-							}
-							if (j > Main.maxTilesY - 200)
-							{
-								type2 = 265;
-							}
-							else if (Main.hardMode)
-							{
-								if (Main.rand.Next(2) == 0)
-								{
-									type2 = 278;
-								}
-								else
-								{
-									type2 = 47;
-								}
-							}
-							Item.NewItem(i * 16, j * 16, 16, 16, type2, stack, false, 0, false, false);
-						}
-						else if (num13 == 4)
-						{
-							int type3 = 28;
-							if (j > Main.maxTilesY - 200 || Main.hardMode)
-							{
-								type3 = 188;
-							}
-							int num15 = 1;
-							if (Main.expertMode && Main.rand.Next(3) != 0)
-							{
-								num15++;
-							}
-							Item.NewItem(i * 16, j * 16, 16, 16, type3, num15, false, 0, false, false);
-						}
-						else if (num13 == 5 && (double)j > Main.rockLayer)
-						{
-							int num16 = Main.rand.Next(4) + 1;
-							if (Main.expertMode)
-							{
-								num16 += Main.rand.Next(4);
-							}
-							Item.NewItem(i * 16, j * 16, 16, 16, 166, num16, false, 0, false, false);
-						}
-						else if ((num13 == 5 || num13 == 6) && j < Main.maxTilesY - 200 && !Main.hardMode)
-						{
-							int stack2 = Main.rand.Next(20, 41);
-							Item.NewItem(i * 16, j * 16, 16, 16, 965, stack2, false, 0, false, false);
-						}
-						else
-						{
-							float num17 = (float)(200 + WorldGen.genRand.Next(-100, 101));
-							if ((double)j < Main.worldSurface)
-							{
-								num17 *= 0.5f;
-							}
-							else if ((double)j < Main.rockLayer)
-							{
-								num17 *= 0.75f;
-							}
-							else if (j > Main.maxTilesY - 250)
-							{
-								num17 *= 1.25f;
-							}
-							num17 *= 1f + (float)Main.rand.Next(-20, 21) * 0.01f;
-							if (Main.rand.Next(4) == 0)
-							{
-								num17 *= 1f + (float)Main.rand.Next(5, 11) * 0.01f;
-							}
-							if (Main.rand.Next(8) == 0)
-							{
-								num17 *= 1f + (float)Main.rand.Next(10, 21) * 0.01f;
-							}
-							if (Main.rand.Next(12) == 0)
-							{
-								num17 *= 1f + (float)Main.rand.Next(20, 41) * 0.01f;
-							}
-							if (Main.rand.Next(16) == 0)
-							{
-								num17 *= 1f + (float)Main.rand.Next(40, 81) * 0.01f;
-							}
-							if (Main.rand.Next(20) == 0)
-							{
-								num17 *= 1f + (float)Main.rand.Next(50, 101) * 0.01f;
-							}
-							if (Main.expertMode)
-							{
-								num17 *= 2.5f;
-							}
-							if (Main.expertMode && Main.rand.Next(2) == 0)
-							{
-								num17 *= 1.25f;
-							}
-							if (Main.expertMode && Main.rand.Next(3) == 0)
-							{
-								num17 *= 1.5f;
-							}
-							if (Main.expertMode && Main.rand.Next(4) == 0)
-							{
-								num17 *= 1.75f;
-							}
-							num17 *= num6;
-							if (NPC.downedBoss1)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedBoss2)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedBoss3)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedMechBoss1)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedMechBoss2)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedMechBoss3)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedPlantBoss)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedQueenBee)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedGolemBoss)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedPirates)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedGoblins)
-							{
-								num17 *= 1.1f;
-							}
-							if (NPC.downedFrost)
-							{
-								num17 *= 1.1f;
-							}
-							while ((int)num17 > 0)
-							{
-								if (num17 > 1000000f)
-								{
-									int num18 = (int)(num17 / 1000000f);
-									if (num18 > 50 && Main.rand.Next(2) == 0)
-									{
-										num18 /= Main.rand.Next(3) + 1;
-									}
-									if (Main.rand.Next(2) == 0)
-									{
-										num18 /= Main.rand.Next(3) + 1;
-									}
-									num17 -= (float)(1000000 * num18);
-									Item.NewItem(i * 16, j * 16, 16, 16, 74, num18, false, 0, false, false);
-								}
-								else if (num17 > 10000f)
-								{
-									int num19 = (int)(num17 / 10000f);
-									if (num19 > 50 && Main.rand.Next(2) == 0)
-									{
-										num19 /= Main.rand.Next(3) + 1;
-									}
-									if (Main.rand.Next(2) == 0)
-									{
-										num19 /= Main.rand.Next(3) + 1;
-									}
-									num17 -= (float)(10000 * num19);
-									Item.NewItem(i * 16, j * 16, 16, 16, 73, num19, false, 0, false, false);
-								}
-								else if (num17 > 100f)
-								{
-									int num20 = (int)(num17 / 100f);
-									if (num20 > 50 && Main.rand.Next(2) == 0)
-									{
-										num20 /= Main.rand.Next(3) + 1;
-									}
-									if (Main.rand.Next(2) == 0)
-									{
-										num20 /= Main.rand.Next(3) + 1;
-									}
-									num17 -= (float)(100 * num20);
-									Item.NewItem(i * 16, j * 16, 16, 16, 72, num20, false, 0, false, false);
-								}
-								else
-								{
-									int num21 = (int)num17;
-									if (num21 > 50 && Main.rand.Next(2) == 0)
-									{
-										num21 /= Main.rand.Next(3) + 1;
-									}
-									if (Main.rand.Next(2) == 0)
-									{
-										num21 /= Main.rand.Next(4) + 1;
-									}
-									if (num21 < 1)
-									{
-										num21 = 1;
-									}
-									num17 -= (float)num21;
-									Item.NewItem(i * 16, j * 16, 16, 16, 71, num21, false, 0, false, false);
+								float num17 = (float)(200 + WorldGen.genRand.Next(-100, 101));
+								if ((double)j < Main.worldSurface)
+								{
+									num17 *= 0.5f;
+								}
+								else if ((double)j < Main.rockLayer)
+								{
+									num17 *= 0.75f;
+								}
+								else if (j > Main.maxTilesY - 250)
+								{
+									num17 *= 1.25f;
+								}
+								num17 *= 1f + (float)Main.rand.Next(-20, 21) * 0.01f;
+								if (Main.rand.Next(4) == 0)
+								{
+									num17 *= 1f + (float)Main.rand.Next(5, 11) * 0.01f;
+								}
+								if (Main.rand.Next(8) == 0)
+								{
+									num17 *= 1f + (float)Main.rand.Next(10, 21) * 0.01f;
+								}
+								if (Main.rand.Next(12) == 0)
+								{
+									num17 *= 1f + (float)Main.rand.Next(20, 41) * 0.01f;
+								}
+								if (Main.rand.Next(16) == 0)
+								{
+									num17 *= 1f + (float)Main.rand.Next(40, 81) * 0.01f;
+								}
+								if (Main.rand.Next(20) == 0)
+								{
+									num17 *= 1f + (float)Main.rand.Next(50, 101) * 0.01f;
+								}
+								if (Main.expertMode)
+								{
+									num17 *= 2.5f;
+								}
+								if (Main.expertMode && Main.rand.Next(2) == 0)
+								{
+									num17 *= 1.25f;
+								}
+								if (Main.expertMode && Main.rand.Next(3) == 0)
+								{
+									num17 *= 1.5f;
+								}
+								if (Main.expertMode && Main.rand.Next(4) == 0)
+								{
+									num17 *= 1.75f;
+								}
+								num17 *= num6;
+								if (NPC.downedBoss1)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedBoss2)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedBoss3)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedMechBoss1)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedMechBoss2)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedMechBoss3)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedPlantBoss)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedQueenBee)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedGolemBoss)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedPirates)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedGoblins)
+								{
+									num17 *= 1.1f;
+								}
+								if (NPC.downedFrost)
+								{
+									num17 *= 1.1f;
+								}
+								while ((int)num17 > 0)
+								{
+									if (num17 > 1000000f)
+									{
+										int num18 = (int)(num17 / 1000000f);
+										if (num18 > 50 && Main.rand.Next(2) == 0)
+										{
+											num18 /= Main.rand.Next(3) + 1;
+										}
+										if (Main.rand.Next(2) == 0)
+										{
+											num18 /= Main.rand.Next(3) + 1;
+										}
+										num17 -= (float)(1000000 * num18);
+										Item.NewItem(i * 16, j * 16, 16, 16, 74, num18, false, 0, false, false);
+									}
+									else if (num17 > 10000f)
+									{
+										int num19 = (int)(num17 / 10000f);
+										if (num19 > 50 && Main.rand.Next(2) == 0)
+										{
+											num19 /= Main.rand.Next(3) + 1;
+										}
+										if (Main.rand.Next(2) == 0)
+										{
+											num19 /= Main.rand.Next(3) + 1;
+										}
+										num17 -= (float)(10000 * num19);
+										Item.NewItem(i * 16, j * 16, 16, 16, 73, num19, false, 0, false, false);
+									}
+									else if (num17 > 100f)
+									{
+										int num20 = (int)(num17 / 100f);
+										if (num20 > 50 && Main.rand.Next(2) == 0)
+										{
+											num20 /= Main.rand.Next(3) + 1;
+										}
+										if (Main.rand.Next(2) == 0)
+										{
+											num20 /= Main.rand.Next(3) + 1;
+										}
+										num17 -= (float)(100 * num20);
+										Item.NewItem(i * 16, j * 16, 16, 16, 72, num20, false, 0, false, false);
+									}
+									else
+									{
+										int num21 = (int)num17;
+										if (num21 > 50 && Main.rand.Next(2) == 0)
+										{
+											num21 /= Main.rand.Next(3) + 1;
+										}
+										if (Main.rand.Next(2) == 0)
+										{
+											num21 /= Main.rand.Next(4) + 1;
+										}
+										if (num21 < 1)
+										{
+											num21 = 1;
+										}
+										num17 -= (float)num21;
+										Item.NewItem(i * 16, j * 16, 16, 16, 71, num21, false, 0, false, false);
+									}
 								}
 							}
 						}
@@ -32967,7 +_,8 @@
 						}
 					}
 				}
-				Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
+				if (TileLoader.Drop(i, j, type, TileStyle.Style2x2))
+					Item.NewItem(i * 16, j * 16, 32, 32, type2, 1, false, 0, false, false);
 				WorldGen.destroyObject = false;
 				if (Main.tile[k, num + 2].type == 138 || Main.tile[k + 1, num + 2].type == 138)
 				{
@@ -33128,10 +_,6 @@
 
 		public static bool PlaceTile(int i, int j, int type, bool mute = false, bool forced = false, int plr = -1, int style = 0)
 		{
-			if (type >= 467)
-			{
-				return false;
-			}
 			bool result = false;
 			if (i >= 0 && j >= 0 && i < Main.maxTilesX && j < Main.maxTilesY)
 			{
@@ -33191,7 +_,7 @@
 								return false;
 							}
 						}
-						else if (type == 3 || type == 20 || type == 24 || type == 27 || type == 32 || type == 51 || type == 69 || type == 72 || type == 201 || type == 352)
+						else if (type == 3 || TileLoader.IsSapling(type) || type == 24 || type == 27 || type == 32 || type == 51 || type == 69 || type == 72 || type == 201 || type == 352)
 						{
 							return false;
 						}
@@ -33409,7 +_,7 @@
 							WorldGen.SquareTileFrame(i, j, true);
 						}
 					}
-					else if (type == 4)
+					else if (TileLoader.IsTorch(type))
 					{
 						if (Main.tile[i - 1, j] == null)
 						{
@@ -33567,7 +_,7 @@
 						WorldGen.PlaceOnTable1x1(i, j, type, style);
 						WorldGen.SquareTileFrame(i, j, true);
 					}
-					else if (type == 14 || type == 26 || type == 86 || type == 87 || type == 88 || type == 89 || type == 114 || type == 186 || type == 187 || type == 215 || type == 217 || type == 218 || type == 377)
+					else if (type == 14 || type == 26 || type == 86 || type == 87 || TileLoader.IsDresser(type) || type == 89 || type == 114 || type == 186 || type == 187 || type == 215 || type == 217 || type == 218 || type == 377)
 					{
 						WorldGen.Place3x2(i, j, (ushort)type, style);
 						WorldGen.SquareTileFrame(i, j, true);
@@ -33582,14 +_,16 @@
 						WorldGen.PlaceJunglePlant(i, j, (ushort)type, 0, 0);
 						WorldGen.SquareTileFrame(i, j, true);
 					}
-					else if (type == 20)
+					else if (TileLoader.IsSapling(type))
 					{
 						if (Main.tile[i, j + 1] == null)
 						{
 							Main.tile[i, j + 1] = new Tile();
 						}
 						int type2 = (int)Main.tile[i, j + 1].type;
-						if (Main.tile[i, j + 1].active() && (type2 == 2 || type2 == 109 || type2 == 147 || type2 == 60 || type2 == 23 || type2 == 199 || type2 == 53 || type2 == 234 || type2 == 116 || type2 == 112))
+						int dummyType = TileID.Saplings;
+						int dummyStyle = 0;
+						if (Main.tile[i, j + 1].active() && (type2 == 2 || type2 == 109 || type2 == 147 || type2 == 60 || type2 == 23 || type2 == 199 || type2 == 53 || type2 == 234 || type2 == 116 || type2 == 112 || TileLoader.SaplingGrowthType(type2, ref dummyType, ref dummyStyle)))
 						{
 							WorldGen.Place1x2(i, j, (ushort)type, style);
 							WorldGen.SquareTileFrame(i, j, true);
@@ -33648,7 +_,7 @@
 						WorldGen.Place2xX(i, j, (ushort)type, style);
 						WorldGen.SquareTileFrame(i, j, true);
 					}
-					else if (type == 21)
+					else if (TileLoader.IsChest(type))
 					{
 						WorldGen.PlaceChest(i, j, (ushort)type, false, style);
 						WorldGen.SquareTileFrame(i, j, true);
@@ -33747,6 +_,10 @@
 					else if (type == 314)
 					{
 						Minecart.PlaceTrack(tile, style);
+					}
+					else if (type >= TileID.Count && TileObjectData.GetTileData(type, style) != null)
+					{
+						PlaceObject(i, j, type, mute, style);
 					}
 					else
 					{
@@ -33813,7 +_,11 @@
 					{
 						fail = true;
 					}
-					if (tile.wall == 21 || tile.wall == 186 || tile.wall == 136 || tile.wall == 137 || tile.wall == 168 || tile.wall == 169 || tile.wall == 172 || tile.wall == 226 || tile.wall == 227)
+					WallLoader.KillWall(i, j, tile.wall, ref fail);
+					if (!WallLoader.KillSound(i, j, tile.wall))
+					{
+					}
+					else if (tile.wall == 21 || tile.wall == 186 || tile.wall == 136 || tile.wall == 137 || tile.wall == 168 || tile.wall == 169 || tile.wall == 172 || tile.wall == 226 || tile.wall == 227)
 					{
 						Main.PlaySound(13, i * 16, j * 16, 1, 1f, 0f);
 					}
@@ -33830,6 +_,7 @@
 					{
 						num = 3;
 					}
+					WallLoader.NumDust(i, j, tile.wall, fail, ref num);
 					for (int k = 0; k < num; k++)
 					{
 						int num2 = 0;
@@ -34309,6 +_,10 @@
 						if (tile.wall == 151 || tile.wall == 152)
 						{
 							num2 = 215;
+						}
+						if (!WallLoader.CreateDust(i, j, tile.wall, ref num2))
+						{
+							continue;
 						}
 						if (tile.wall == 44)
 						{
@@ -34833,14 +_,14 @@
 					{
 						num4 = 2210 + (int)tile.wall - 138;
 					}
-					if (num4 > 0)
+					if (WallLoader.Drop(i, j, tile.wall, ref num4) && num4 > 0)
 					{
 						Item.NewItem(i * 16, j * 16, 16, 16, num4, 1, false, 0, false, false);
 					}
 					tile.wall = 0;
 					tile.wallColor(0);
 					WorldGen.SquareWallFrame(i, j, true);
-					if (tile.type >= 0 && tile.type < 467 && TileID.Sets.FramesOnKillWall[(int)tile.type])
+					if (tile.type >= 0 && TileID.Sets.FramesOnKillWall[(int)tile.type])
 					{
 						WorldGen.TileFrame(i, j, false, false);
 					}
@@ -34911,6 +_,10 @@
 			{
 				return false;
 			}
+			if (!TileLoader.CanKillTile(i, j, tile.type, ref blockDamaged))
+			{
+				return false;
+			}
 			if (j >= 1)
 			{
 				tile2 = Main.tile[i, j - 1];
@@ -34919,11 +_,11 @@
 			{
 				int type = (int)tile2.type;
 				int num = type;
-				if (num <= 26)
+				if (num <= 26 || TileLoader.IsChest(num))
 				{
 					if (num != 5)
 					{
-						if (num != 21 && num != 26)
+						if (!TileLoader.IsChest(num) && num != 26)
 						{
 							goto IL_12B;
 						}
@@ -34937,7 +_,7 @@
 						goto IL_12B;
 					}
 				}
-				else if (num != 72 && num != 88)
+				else if (num != 72 && !TileLoader.IsDresser(num))
 				{
 					if (num != 323)
 					{
@@ -34956,11 +_,11 @@
 			}
 			IL_12B:
 			ushort type2 = tile.type;
-			if (type2 <= 21)
+			if (type2 <= 21 || TileLoader.IsChest(type2))
 			{
 				if (type2 != 10)
 				{
-					if (type2 == 21)
+					if (TileLoader.IsChest(type2))
 					{
 						if (!Chest.CanDestroyChest(i - (int)(tile.frameX / 18 % 2), j - (int)(tile.frameY / 18)))
 						{
@@ -34974,7 +_,7 @@
 					return false;
 				}
 			}
-			else if (type2 != 88)
+			else if (!TileLoader.IsDresser(type2))
 			{
 				if (type2 != 138)
 				{
@@ -34983,7 +_,7 @@
 						int num2 = i - (int)(tile.frameX % 54 / 18);
 						for (int k = 0; k < 3; k++)
 						{
-							if (Main.tile[num2 + k, j - 1].active() && (Main.tile[num2 + k, j - 1].type == 21 || Main.tile[num2 + k, j - 1].type == 441))
+							if (Main.tile[num2 + k, j - 1].active() && (TileLoader.IsChest(Main.tile[num2 + k, j - 1].type) || Main.tile[num2 + k, j - 1].type == 441))
 							{
 								blockDamaged = true;
 								return false;
@@ -35020,7 +_,7 @@
 					{
 						Main.tile[i, j - 1] = new Tile();
 					}
-					if (j >= 1 && Main.tile[i, j - 1].active() && ((Main.tile[i, j - 1].type == 5 && tile.type != 5) || (Main.tile[i, j - 1].type == 323 && tile.type != 323) || (Main.tile[i, j - 1].type == 21 && tile.type != 21) || (Main.tile[i, j - 1].type == 323 && tile.type != 323) || (Main.tile[i, j - 1].type == 88 && tile.type != 88) || (Main.tile[i, j - 1].type == 26 && tile.type != 26) || (Main.tile[i, j - 1].type == 72 && tile.type != 72)))
+					if (j >= 1 && Main.tile[i, j - 1].active() && ((Main.tile[i, j - 1].type == 5 && tile.type != 5) || (Main.tile[i, j - 1].type == 323 && tile.type != 323) || (TileLoader.IsChest(Main.tile[i, j - 1].type) && !TileLoader.IsChest(tile.type)) || (Main.tile[i, j - 1].type == 323 && tile.type != 323) || (TileLoader.IsDresser(Main.tile[i, j - 1].type) && !TileLoader.IsDresser(tile.type)) || (Main.tile[i, j - 1].type == 26 && tile.type != 26) || (Main.tile[i, j - 1].type == 72 && tile.type != 72)))
 					{
 						if (Main.tile[i, j - 1].type == 5)
 						{
@@ -35048,20 +_,24 @@
 						int num = i - frameX % 54 / 18;
 						for (int k = 0; k < 3; k++)
 						{
-							if (Main.tile[num + k, j - 1].active() && (Main.tile[num + k, j - 1].type == 21 || Main.tile[num + k, j - 1].type == 441 || Main.tile[num + k, j - 1].type == 88))
+							if (Main.tile[num + k, j - 1].active() && (TileLoader.IsChest(Main.tile[num + k, j - 1].type) || Main.tile[num + k, j - 1].type == 441 || TileLoader.IsDresser(Main.tile[num + k, j - 1].type)))
 							{
 								fail = true;
 								break;
 							}
 						}
 					}
+					TileLoader.KillTile(i, j, tile.type, ref fail, ref effectOnly, ref noItem);
 					if (!effectOnly && !WorldGen.stopDrops)
 					{
 						if (!noItem && FixExploitManEaters.SpotProtected(i, j))
 						{
 							return;
 						}
-						if (tile.type == 127)
+						if (!TileLoader.KillSound(i, j, tile.type))
+						{
+						}
+						else if (tile.type == 127)
 						{
 							Main.PlaySound(SoundID.Item27, i * 16, j * 16);
 						}
@@ -35262,7 +_,7 @@
 							return;
 						}
 					}
-					int num13 = WorldGen.KillTile_GetTileDustAmount(fail, tile);
+					int num13 = WorldGen.KillTile_GetTileDustAmount(fail, tile, i, j);
 					for (int num14 = 0; num14 < num13; num14++)
 					{
 						WorldGen.KillTile_MakeTileDust(i, j, tile);
@@ -35288,7 +_,7 @@
 						WorldGen.SquareTileFrame(i, j, true);
 						return;
 					}
-					if (tile.type == 21 && Main.netMode != 1)
+					if (TileLoader.IsChest(tile.type) && Main.netMode != 1)
 					{
 						int num15 = (int)(tile.frameX / 18);
 						int y = j - (int)(tile.frameY / 18);
@@ -35302,7 +_,7 @@
 							return;
 						}
 					}
-					if (tile.type == 88 && Main.netMode != 1)
+					if (TileLoader.IsDresser(tile.type) && Main.netMode != 1)
 					{
 						int num16 = (int)(tile.frameX / 18);
 						int y2 = j - (int)(tile.frameY / 18);
@@ -35335,6 +_,7 @@
 						}
 						if (tile.type == 73)
 						{
+							//patch file: num17, num18
 							num17 = 200;
 							num18 = 50;
 							if (tile.frameX >= 108)
@@ -35396,6 +_,7 @@
 						{
 							num19 = 10;
 						}
+						TileLoader.DropCritterChance(i, j, tile.type, ref num17, ref num18, ref num19);
 						if (num17 > 0 && NPC.CountNPCS(357) < 5 && WorldGen.genRand.Next(num17) == 0)
 						{
 							int type = 357;
@@ -35764,7 +_,7 @@
 										}
 										if (Main.tile[i, num29] != null)
 										{
-											if (Main.tile[i, num29].type == 2 || Main.tile[i, num29].type == 109 || Main.tile[i, num29].type == 147 || Main.tile[i, num29].type == 199 || Main.tile[i, num29].type == 23)
+											if (Main.tile[i, num29].type == 2 || Main.tile[i, num29].type == 109 || Main.tile[i, num29].type == 147 || Main.tile[i, num29].type == 199 || Main.tile[i, num29].type == 23 || TileLoader.CanDropAcorn(Main.tile[i, num29].type))
 											{
 												num23 = 9;
 												num24 = 27;
@@ -35820,6 +_,7 @@
 								if (Main.tile[num30, num31].active())
 								{
 									ushort type4 = Main.tile[num30, num31].type;
+									//patch file: type4
 									if (type4 <= 70)
 									{
 										if (type4 != 23)
@@ -35859,6 +_,7 @@
 									{
 										num23 = 621;
 									}
+									TileLoader.DropTreeWood(type4, ref num23);
 								}
 								int num32 = (int)Player.FindClosest(new Vector2((float)(num30 * 16), (float)(num31 * 16)), 16, 16);
 								int axe = Main.player[num32].inventory[Main.player[num32].selectedItem].axe;
@@ -35883,6 +_,7 @@
 							if (Main.tile[i, num33].active())
 							{
 								ushort type4 = Main.tile[i, num33].type;
+								//patch file: type4
 								if (type4 != 112)
 								{
 									if (type4 != 116)
@@ -35901,6 +_,7 @@
 								{
 									num23 = 619;
 								}
+								TileLoader.DropPalmTreeWood(type4, ref num23);
 							}
 						}
 						else if (tile.type == 408)
@@ -37199,7 +_,8 @@
 						{
 							num23 = 2504;
 						}
-						if (num23 > 0)
+						bool vanillaDrop = TileLoader.Drop(i, j, tile.type, TileStyle.Style1x1);
+						if (vanillaDrop && num23 > 0)
 						{
 							int num45 = 1;
 							if (flag)
@@ -37208,7 +_,7 @@
 							}
 							Item.NewItem(i * 16, j * 16, 16, 16, num23, num45, false, -1, false, false);
 						}
-						if (num24 > 0)
+						if (vanillaDrop && num24 > 0)
 						{
 							Item.NewItem(i * 16, j * 16, 16, 16, num24, 1, false, -1, false, false);
 						}
@@ -37243,7 +_,7 @@
 			}
 		}
 
-		public static int KillTile_GetTileDustAmount(bool fail, Tile tileCache)
+		public static int KillTile_GetTileDustAmount(bool fail, Tile tileCache, int i, int j)
 		{
 			int result = 10;
 			if (tileCache.type == 231)
@@ -37298,6 +_,7 @@
 			{
 				result = 0;
 			}
+			TileLoader.NumDust(i, j, tileCache.type, fail, ref result);
 			return result;
 		}
 
@@ -38338,10 +_,12 @@
 						{
 							num = 121;
 						}
+						//patch file: num13, num14
 						if (Main.tile[num13, num14].active() && Main.tile[num13, num14].type == 147)
 						{
 							num = 122;
 						}
+						TileLoader.TreeDust(Main.tile[num13, num14], ref num);
 					}
 				}
 			}
@@ -38365,10 +_,12 @@
 						{
 							num = 79;
 						}
+						//patch file: num15
 						if (Main.tile[i, num15].active() && Main.tile[i, num15].type == 112)
 						{
 							num = 77;
 						}
+						TileLoader.PalmTreeDust(Main.tile[i, num15], ref num);
 					}
 				}
 			}
@@ -39319,7 +_,7 @@
 			}
 			flag = true;
 			IL_2514:
-			if (num < 0)
+			if (!TileLoader.CreateDust(i, j, tileCache.type, ref num) || num < 0) // TODO, fix
 			{
 				return 6000;
 			}
@@ -41253,6 +_,7 @@
 
 		public static void UpdateWorld()
 		{
+			WorldHooks.PreUpdate();
 			int num = 20;
 			int maxValue = 40;
 			if (Main.expertMode)
@@ -41327,6 +_,7 @@
 				}
 				int num7 = WorldGen.genRand.Next(10, Main.maxTilesX - 10);
 				int num8 = WorldGen.genRand.Next(10, (int)Main.worldSurface - 1);
+				//patch file: num7, num8
 				int num9 = num7 - 1;
 				int num10 = num7 + 2;
 				int num11 = num8 - 1;
@@ -42093,6 +_,8 @@
 							}
 						}
 					}
+					TileLoader.RandomUpdate(num7, num8, Main.tile[num7, num8].type);
+					WallLoader.RandomUpdate(num7, num8, Main.tile[num7, num8].wall);
 				}
 				num6++;
 			}
@@ -42863,6 +_,8 @@
 						}
 					}
 					WorldGen.SpreadDesertWalls(num, num64, num65);
+					TileLoader.RandomUpdate(num64, num65, Main.tile[num64, num65].type);
+					WallLoader.RandomUpdate(num64, num65, Main.tile[num64, num65].wall);
 				}
 				num63++;
 			}
@@ -42886,6 +_,7 @@
 					Projectile.NewProjectile(vector.X, vector.Y, num147, num148, 12, 1000, 10f, Main.myPlayer, 0f, 0f);
 				}
 			}
+			WorldHooks.PostUpdate();
 		}
 
 		public static void SpreadDesertWalls(int wallDist, int i, int j)
@@ -43027,7 +_,7 @@
 			}
 			if (Main.tile[i, j].wall == 0)
 			{
-				Main.tile[i, j].wall = (byte)type;
+				Main.tile[i, j].wall = (ushort)type;
 				WorldGen.SquareWallFrame(i, j, true);
 				if (!mute)
 				{
@@ -46854,11 +_,11 @@
 			if (Main.tile[i, j - 1].active())
 			{
 				ushort type2 = Main.tile[i, j - 1].type;
-				if (type2 <= 72)
-				{
-					if (type2 <= 21)
-					{
-						if (type2 != 5 && type2 != 21)
+				if (type2 <= 72 || TileLoader.IsChest(type2))
+				{
+					if (type2 <= 21 || TileLoader.IsChest(type2))
+					{
+						if (type2 != 5 && !TileLoader.IsChest(type2))
 						{
 							return true;
 						}
@@ -46868,9 +_,9 @@
 						return true;
 					}
 				}
-				else if (type2 <= 88)
-				{
-					if (type2 != 77 && type2 != 88)
+				else if (type2 <= 88 || TileLoader.IsDresser(type2))
+				{
+					if (type2 != 77 && !TileLoader.IsDresser(type2))
 					{
 						return true;
 					}
@@ -47384,7 +_,11 @@
 					}
 					if (tile.active())
 					{
-						if (noBreak && Main.tileFrameImportant[(int)tile.type] && tile.type != 4)
+						if (!TileLoader.TileFrame(i, j, tile.type, ref resetFrame, ref noBreak))
+						{
+							return;
+						}
+						if (noBreak && Main.tileFrameImportant[(int)tile.type] && !TileLoader.IsTorch(tile.type))
 						{
 							return;
 						}
@@ -47398,7 +_,7 @@
 						Rectangle rectangle = new Rectangle(-1, -1, 0, 0);
 						if (Main.tileFrameImportant[(int)tile.type])
 						{
-							if (num == 4)
+							if (TileLoader.IsTorch(num))
 							{
 								Tile tile2 = Main.tile[i, j - 1];
 								Tile tile3 = Main.tile[i, j + 1];
@@ -48376,7 +_,7 @@
 							{
 								WorldGen.Check3x3(i, j, (int)((ushort)num));
 							}
-							else if (num == 15 || num == 20 || num == 216 || num == 338 || num == 390)
+							else if (num == 15 || TileLoader.IsSapling(num) || num == 216 || num == 338 || num == 390)
 							{
 								WorldGen.Check1x2(i, j, (ushort)num);
 							}
@@ -48566,6 +_,10 @@
 							else if (num == 323)
 							{
 								WorldGen.CheckPalmTree(i, j);
+							}
+							else
+							{
+								TileLoader.CheckModTile(i, j, num);
 							}
 							return;
 						}
@@ -48716,11 +_,11 @@
 								num58 = -1;
 								num56 = -1;
 							}
-							if (num == 147)
+							if (TileID.Sets.Snow[num])
 							{
 								WorldGen.TileMergeAttempt(num, Main.tileBrick, TileID.Sets.Ices, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
-							else if (num == 161 || num == 163 || num == 164 || num == 200)
+							else if (TileID.Sets.Ices[num])
 							{
 								WorldGen.TileMergeAttempt(num, Main.tileBrick, TileID.Sets.Snow, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
@@ -48730,7 +_,7 @@
 							}
 							else if (Main.tileBrick[num])
 							{
-								if (num == 60 || num == 70)
+								if (TileID.Sets.GrassSpecial[num])
 								{
 									WorldGen.TileMergeAttempt(num, Main.tileBrick, TileID.Sets.Mud, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 								}
@@ -48743,7 +_,7 @@
 							{
 								WorldGen.TileMergeAttempt(num, Main.tilePile, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
-							if ((num == 1 || Main.tileMoss[num] || num == 117 || num == 25 || num == 203) && num58 == 165)
+							if ((TileID.Sets.Stone[num] || Main.tileMoss[num]) && num58 == 165)
 							{
 								if (tile3.frameY == 72)
 								{
@@ -48754,7 +_,7 @@
 									num58 = num;
 								}
 							}
-							if ((num == 1 || Main.tileMoss[num] || num == 117 || num == 25 || num == 203) && num53 == 165)
+							if ((TileID.Sets.Stone[num] || Main.tileMoss[num]) && num53 == 165)
 							{
 								if (tile2.frameY == 90)
 								{
@@ -48776,7 +_,7 @@
 									num53 = num;
 								}
 							}
-							if ((num == 200 || num == 161 || num == 163 || num == 164) && num58 == 165)
+							if (TileID.Sets.Ices[num] && num58 == 165)
 							{
 								num58 = num;
 							}
@@ -48920,7 +_,7 @@
 										num53 = num;
 									}
 								}
-								else if (num53 == 147)
+								else if (num53 > -1 && TileID.Sets.Snow[num53])
 								{
 									WorldGen.TileFrame(i, j - 1, false, false);
 									if (WorldGen.mergeDown)
@@ -48936,7 +_,7 @@
 										num58 = num;
 									}
 								}
-								else if (num58 == 147)
+								else if (num58 > -1 && TileID.Sets.Snow[num58])
 								{
 									WorldGen.TileFrame(i, j + 1, false, false);
 									if (WorldGen.mergeUp)
@@ -48952,7 +_,7 @@
 										num55 = num;
 									}
 								}
-								else if (num55 == 147)
+								else if (num55 > -1 && TileID.Sets.Snow[num55])
 								{
 									WorldGen.TileFrame(i - 1, j, false, false);
 									if (WorldGen.mergeRight)
@@ -48968,7 +_,7 @@
 										num56 = num;
 									}
 								}
-								else if (num56 == 147)
+								else if (num56 > -1 && TileID.Sets.Snow[num56])
 								{
 									WorldGen.TileFrame(i + 1, j, false, false);
 									if (WorldGen.mergeLeft)
@@ -48976,19 +_,19 @@
 										num56 = num;
 									}
 								}
-								if (num53 == 2 || num53 == 23 || num53 == 109 || num53 == 199)
+								if (num53 > -1 && TileID.Sets.Grass[num53])
 								{
 									num53 = num;
 								}
-								if (num58 == 2 || num58 == 23 || num58 == 109 || num58 == 199)
+								if (num58 > -1 && TileID.Sets.Grass[num58])
 								{
 									num58 = num;
 								}
-								if (num55 == 2 || num55 == 23 || num55 == 109 || num55 == 199)
+								if (num55 > -1 && TileID.Sets.Grass[num55])
 								{
 									num55 = num;
 								}
-								if (num56 == 2 || num56 == 23 || num56 == 109 || num56 == 199)
+								if (num56 > -1 && TileID.Sets.Grass[num56])
 								{
 									num56 = num;
 								}
@@ -48996,7 +_,7 @@
 								{
 									num52 = num;
 								}
-								else if (num52 == 2 || num52 == 23 || num52 == 109 || num52 == 199)
+								else if (num52 > -1 && TileID.Sets.Grass[num52])
 								{
 									num52 = num;
 								}
@@ -49004,7 +_,7 @@
 								{
 									num54 = num;
 								}
-								else if (num54 == 2 || num54 == 23 || num54 == 109 || num54 == 199)
+								else if (num54 > -1 && TileID.Sets.Grass[num54])
 								{
 									num54 = num;
 								}
@@ -49012,7 +_,7 @@
 								{
 									num57 = num;
 								}
-								else if (num57 == 2 || num57 == 23 || num57 == 109 || num57 == 199)
+								else if (num57 > -1 && TileID.Sets.Grass[num57])
 								{
 									num57 = num;
 								}
@@ -49020,7 +_,7 @@
 								{
 									num59 = num;
 								}
-								else if (num59 == 2 || num59 == 23 || num59 == 109 || num59 == 199)
+								else if (num59 > -1 && TileID.Sets.Grass[num59])
 								{
 									num59 = num;
 								}
@@ -49081,7 +_,7 @@
 									WorldGen.TileMergeAttemptFrametest(i, j, num, 57, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 								}
 							}
-							else if (num == 58 || num == 76 || num == 75)
+							else if (TileID.Sets.HellSpecial[num])
 							{
 								WorldGen.TileMergeAttempt(-2, 57, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
@@ -49090,7 +_,7 @@
 								WorldGen.TileMergeAttempt(-2, 1, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 								WorldGen.TileMergeAttemptFrametest(i, j, num, TileID.Sets.HellSpecial, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
-							else if (num == 59)
+							else if (TileID.Sets.Mud[num])
 							{
 								if ((double)j > Main.rockLayer)
 								{
@@ -49128,11 +_,11 @@
 							{
 								WorldGen.TileMergeAttempt(-2, 189, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
-							else if (num == 147)
+							else if (TileID.Sets.Snow[num])
 							{
 								WorldGen.TileMergeAttemptFrametest(i, j, num, TileID.Sets.IcesSlush, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
-							else if (num == 161 || num == 163 || num == 164 || num == 200 || num == 224)
+							else if (TileID.Sets.IcesSlush[num])
 							{
 								WorldGen.TileMergeAttempt(-2, 147, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 							}
@@ -49258,12 +_,12 @@
 								num56 = num;
 								WorldGen.mergeRight = true;
 							}
-							if (num == 2 || num == 23 || num == 60 || num == 70 || num == 109 || num == 199 || Main.tileMoss[num])
+							if (TileID.Sets.Grass[num] || TileID.Sets.GrassSpecial[num] || Main.tileMoss[num])
 							{
 								flag8 = true;
 								WorldGen.TileMergeAttemptWeird(num, -1, Main.tileSolid, ref num53, ref num58, ref num55, ref num56, ref num52, ref num54, ref num57, ref num59);
 								int num63 = 0;
-								if (num == 60 || num == 70)
+								if (TileID.Sets.GrassSpecial[num])
 								{
 									num63 = 59;
 								}
@@ -51904,7 +_,7 @@
 									if (tile3 != null && !tile3.active())
 									{
 										bool flag18 = true;
-										if (tile2.active() && (tile2.type == 21 || tile2.type == 441 || tile2.type == 323 || tile2.type == 88))
+										if (tile2.active() && (TileLoader.IsChest(tile2.type) || tile2.type == 441 || tile2.type == 323 || TileLoader.IsDresser(tile2.type)))
 										{
 											flag18 = false;
 										}
@@ -51970,7 +_,7 @@
 								else if (Main.netMode == 2 && tile3 != null && !tile3.active())
 								{
 									bool flag19 = true;
-									if (tile2.active() && (tile2.type == 21 || tile2.type == 441 || tile2.type == 323 || tile2.type == 88))
+									if (tile2.active() && (TileLoader.IsChest(tile2.type) || tile2.type == 441 || tile2.type == 323 || TileLoader.IsDresser(tile2.type)))
 									{
 										flag19 = false;
 									}
@@ -52052,7 +_,11 @@
 							if (rectangle.X != frameX && rectangle.Y != frameY && frameX >= 0 && frameY >= 0)
 							{
 								WorldGen.tileReframeCount++;
+#if DEBUG
+								if (WorldGen.tileReframeCount < 20)
+#else
 								if (WorldGen.tileReframeCount < 100)
+#endif
 								{
 									bool flag21 = WorldGen.mergeUp;
 									bool flag22 = WorldGen.mergeDown;

